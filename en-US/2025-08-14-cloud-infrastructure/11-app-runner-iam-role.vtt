WEBVTT

1
00:00:00.240 --> 00:00:02.320
&gt;&gt; Erik Reinert: Awesome, so
our policy has been created.

2
00:00:02.320 --> 00:00:06.165
Now we need to create one more thing,
which is a role.

3
00:00:06.165 --> 00:00:10.739
So Amazon and how its management works
is basically, you have policies,

4
00:00:10.739 --> 00:00:15.680
policies are attached to roles,
and then users use roles, right?

5
00:00:15.680 --> 00:00:18.057
And so that's kind of what
we are recreating here,

6
00:00:18.057 --> 00:00:20.400
we're basically creating a policy.

7
00:00:20.400 --> 00:00:21.744
We're creating the role, but

8
00:00:21.744 --> 00:00:25.120
we don't have to create the user
because Amazon's the user in this case.

9
00:00:25.120 --> 00:00:30.250
So we only really have to tell Amazon,
hey, here's what you're allowed access to.

10
00:00:30.250 --> 00:00:34.330
And then here's the role that
we want you to be able to use.

11
00:00:34.330 --> 00:00:36.927
And so what we're gonna do
is after we create a policy,

12
00:00:36.927 --> 00:00:38.399
we're then gonna go to Roles.

13
00:00:38.399 --> 00:00:39.610
We're gonna click Create Role.

14
00:00:41.930 --> 00:00:46.210
I'm going to click Custom Trust Policy
because unfortunately,

15
00:00:46.210 --> 00:00:49.570
I'm sorry,
there isn't App Runner in this list.

16
00:00:49.570 --> 00:00:53.650
I don't know why App Runner is
not in this list, but it's not.

17
00:00:53.650 --> 00:00:58.860
And so we have to create a custom trust
policy and copy a few more lines of code.

18
00:00:58.860 --> 00:01:01.894
And so what I'm gonna do is
I'm gonna paste this in, and

19
00:01:01.894 --> 00:01:04.940
then here I'll give you
the second thing you wanna use.

20
00:01:06.380 --> 00:01:12.060
So this at the top is for the policy,
and then this is for the role.

21
00:01:12.060 --> 00:01:16.695
And so basically what we're
doing is we're telling

22
00:01:16.695 --> 00:01:21.420
Amazon how this role can
work with Amazon Services.

23
00:01:21.420 --> 00:01:25.740
We're basically saying, hey,
this role can assume role in the tasks.

24
00:01:28.340 --> 00:01:32.900
And so you need this so that
App Runner can use its own custom role.

25
00:01:32.900 --> 00:01:34.500
Okay, so I'm gonna click next.

26
00:01:34.500 --> 00:01:38.660
It's gonna say, well, hey, do you have
any policies that you wanna attach?

27
00:01:38.660 --> 00:01:39.492
Yes, I do.

28
00:01:39.492 --> 00:01:41.420
I wanna attach the policy
that I just created.

29
00:01:41.420 --> 00:01:43.460
So I type in the search bar FEM.

30
00:01:43.460 --> 00:01:45.620
You'll see my FEM FD service.

31
00:01:45.620 --> 00:01:51.140
And so now you can see how we're attaching
the permissions to the role, right?

32
00:01:51.140 --> 00:01:57.160
Then we click next, and then we're gonna
do FEM FD service as the role name.

33
00:01:57.160 --> 00:02:00.818
Again, our trust policy
is basically saying, hey,

34
00:02:00.818 --> 00:02:07.080
anything that this role uses on
tasks.apprunner.amazonaws.com, I can use.

35
00:02:07.080 --> 00:02:10.145
And then the policy says, okay,

36
00:02:10.145 --> 00:02:15.291
these are the actual things
that I'm allowed to request

37
00:02:15.291 --> 00:02:20.120
through SSM when I'm assumed
as that role all good.

38
00:02:21.570 --> 00:02:22.770
Then we click Create Role.

39
00:02:24.370 --> 00:02:28.038
There may be a little confusion
where you might look at this and go,

40
00:02:28.038 --> 00:02:29.570
we just created a policy.

41
00:02:29.570 --> 00:02:31.090
Why are we creating another policy?

42
00:02:32.930 --> 00:02:38.220
Amazon, again, is really confusing and

43
00:02:38.220 --> 00:02:42.763
I am especially is very confusing.

44
00:02:42.763 --> 00:02:47.924
Effectively what you're doing
with a roles that's called what's

45
00:02:47.924 --> 00:02:53.625
called an assume policy, which tells
Amazon where you can use this role and

46
00:02:53.625 --> 00:02:59.120
what services on like a high level
of like domain, what you can use.

47
00:02:59.120 --> 00:03:02.480
It's just like granting
access to the thing, right?

48
00:03:02.480 --> 00:03:06.560
But that doesn't mean that you can use
the things inside of the thing that you're

49
00:03:06.560 --> 00:03:07.640
accessing, right?

50
00:03:07.640 --> 00:03:09.280
That's what a policy does.

51
00:03:09.280 --> 00:03:13.185
So a policy says these are the things
inside of that big thing that you're

52
00:03:13.185 --> 00:03:16.840
trying to access,
this is the granularity control.

53
00:03:16.840 --> 00:03:19.602
But if you wanna even use the thing,

54
00:03:19.602 --> 00:03:23.560
you have to tell me what
the role is allowed to use.

55
00:03:23.560 --> 00:03:25.080
So it's a combination of the two.

56
00:03:25.080 --> 00:03:28.735
It's what a role can access
from a service level and

57
00:03:28.735 --> 00:03:32.440
then what inside of that
service can it use?

58
00:03:32.440 --> 00:03:33.958
So they get glued together and

59
00:03:33.958 --> 00:03:37.000
then that's how it creates its
permission sets and stuff.

60
00:03:37.000 --> 00:03:42.610
So, yeah, one is an assume policy and
the other one is just a normal policy.

61
00:03:42.610 --> 00:03:48.628
And assuming means like,
I want to use this thing on Amazon,

62
00:03:48.628 --> 00:03:51.936
I'm assuming a role to use that.

