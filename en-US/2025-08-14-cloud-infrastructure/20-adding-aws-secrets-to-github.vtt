WEBVTT

1
00:00:00.160 --> 00:00:04.968
&gt;&gt; Erik Reinert: The next steps are really
going to be building out the pipeline,

2
00:00:04.968 --> 00:00:09.600
but at the bare minimum,
this is all you need to get started.

3
00:00:09.600 --> 00:00:10.902
Just a couple of lines and

4
00:00:10.902 --> 00:00:14.320
running the make command that
you're already running locally.

5
00:00:16.640 --> 00:00:22.463
While this is running in the background,
the next thing we want to do is,

6
00:00:22.463 --> 00:00:26.663
or actually I'm curious if
anyone can guess right,

7
00:00:26.663 --> 00:00:31.530
we have the build image,
but we don't have the push.

8
00:00:31.530 --> 00:00:33.210
We wanna add the push.

9
00:00:33.210 --> 00:00:37.884
But what is something that
GitHub Actions may need

10
00:00:37.884 --> 00:00:41.343
that you also need to push to Amazon?

11
00:00:41.343 --> 00:00:42.380
&gt;&gt; Speaker 2: CLI.

12
00:00:42.380 --> 00:00:44.730
&gt;&gt; Erik Reinert: CLI and-
&gt;&gt; Speaker 3: Secrets.

13
00:00:44.730 --> 00:00:45.447
&gt;&gt; Erik Reinert: Secrets.

14
00:00:45.447 --> 00:00:46.130
Exactly.

15
00:00:46.130 --> 00:00:46.970
Yes.

16
00:00:46.970 --> 00:00:50.250
So what we want to do now is
we want to solve the problem.

17
00:00:50.250 --> 00:00:52.250
You can see here my
pipeline was successful.

18
00:00:53.340 --> 00:00:58.220
So if I go back to my pr,
I have a green check mark.

19
00:00:58.220 --> 00:00:59.820
Awesome.
We're all good to go.

20
00:00:59.820 --> 00:01:03.340
But I'm not pushing yet and
I want to make sure that I can.

21
00:01:03.340 --> 00:01:07.180
So what we want to do is we want
to create a user in IAM that

22
00:01:07.180 --> 00:01:11.856
the GitHub Actions Runner will use
to authenticate with Amazon and

23
00:01:11.856 --> 00:01:16.300
pull and push and do everything
that it needs to with Amazon.

24
00:01:16.300 --> 00:01:20.362
So what I'm going to do is I'm
going to log back into Amazon,

25
00:01:20.362 --> 00:01:23.455
I'm going to go to the console
&gt;&gt; Erik Reinert: And

26
00:01:23.455 --> 00:01:26.120
I'm going to go to the IAM section here.

27
00:01:28.360 --> 00:01:32.826
So once I get to the IAM section,
I'm going to click on Users again and

28
00:01:32.826 --> 00:01:35.080
I'm going to create a user.

29
00:01:35.080 --> 00:01:39.864
I'm going to call this Fem FD
service GitHub Actions,

30
00:01:39.864 --> 00:01:44.440
just so that I know that
it's a GitHub Actions user.

31
00:01:45.970 --> 00:01:48.130
Then I'm going to click the next button.

32
00:01:48.130 --> 00:01:51.490
I'm going to click
Attach Policies directly.

33
00:01:53.090 --> 00:01:56.092
Now, before the next thing I do,

34
00:01:56.092 --> 00:02:01.250
I want you to be aware that you
do not have to do it this way.

35
00:02:02.370 --> 00:02:07.047
I am going to be lazy and
give the key access to my entire Amazon

36
00:02:07.047 --> 00:02:10.850
account with every resource inside of it.

37
00:02:10.850 --> 00:02:15.645
Now, that does mean that if my CI was to
be exploited in any way, shape or form and

38
00:02:15.645 --> 00:02:20.442
they got these credentials, they could
literally do whatever they wanted in my

39
00:02:20.442 --> 00:02:24.021
Amazon account as a future thing
that you can do if you want,

40
00:02:24.021 --> 00:02:27.190
you can set up more granular
permissions to make it.

41
00:02:27.190 --> 00:02:32.273
So I only want you to pull or effectively
whatever you're going to do in CI,

42
00:02:32.273 --> 00:02:35.017
put the permissions in there to make it so

43
00:02:35.017 --> 00:02:38.990
that those are the only things
that this key can do for now.

44
00:02:38.990 --> 00:02:43.520
To just unblock us and not have to
worry about this, I'm just going to do.

45
00:02:43.520 --> 00:02:47.235
But as I said before, with the user that
you've created Just be aware that these

46
00:02:47.235 --> 00:02:50.480
are root level credentials and
stuff like that.

47
00:02:50.480 --> 00:02:51.720
I'm going to click that.

48
00:02:51.720 --> 00:02:55.600
I'm going to hit next and
then I'm going to click Create User.

49
00:02:55.600 --> 00:02:56.640
Bam.
There we go.

50
00:02:56.640 --> 00:02:59.520
I have created an entire new user.

51
00:02:59.520 --> 00:03:05.453
Now, just like we created the service or
the credentials before for

52
00:03:05.453 --> 00:03:09.210
the local access if you needed to, right?

53
00:03:09.210 --> 00:03:14.523
We're going to click on that user, we're
going to go to Security credentials and

54
00:03:14.523 --> 00:03:17.850
then in here I'm going
to create an access key.

55
00:03:17.850 --> 00:03:19.610
So I'm going to click Create Access key.

56
00:03:21.210 --> 00:03:24.988
I'm going to click on Command line
interface because we want to use

57
00:03:24.988 --> 00:03:27.610
it the exact same way that we do locally.

58
00:03:27.610 --> 00:03:28.490
Click.
I understand.

59
00:03:29.850 --> 00:03:33.290
Click next and
then click Create Access key.

60
00:03:33.290 --> 00:03:34.170
And there we go.

61
00:03:34.170 --> 00:03:38.070
Now I have my access key and
my secret access key.

62
00:03:39.990 --> 00:03:43.212
So what I'm going to do really quickly is
I'm just going to download the CSV just so

63
00:03:43.212 --> 00:03:44.710
that I have it.

64
00:03:44.710 --> 00:03:48.725
Now what we want to do is we actually
want to go to GitHub Actions and

65
00:03:48.725 --> 00:03:51.510
add these as secret
values to our pipeline.

66
00:03:51.510 --> 00:03:55.744
So what we're going to do is we're going
to go back to GitHub Actions, we're going

67
00:03:55.744 --> 00:04:00.099
to go to Settings or not GitHub Actions,
but GitHub, we're going to go to Settings,

68
00:04:00.099 --> 00:04:03.750
we're going to click on Secrets and
variables and then click Actions.

69
00:04:06.750 --> 00:04:12.585
Now, what you'll see is you'll see that
I already have an access key ID or

70
00:04:12.585 --> 00:04:16.350
an AWS Secret access key and
kind of spoilers for

71
00:04:16.350 --> 00:04:20.230
in the future and
also a goose DB string, right?

72
00:04:20.230 --> 00:04:24.897
So what I want you to do is I want
you to create two new variables or

73
00:04:24.897 --> 00:04:26.230
two new secrets.

74
00:04:26.230 --> 00:04:30.720
Access Key ID and
Secret access key in this repository.

75
00:04:30.720 --> 00:04:34.743
And so to do that you'll just grab
the value or the key that you want,

76
00:04:34.743 --> 00:04:39.333
click New Repository Secret, paste in
the name and then paste in the value and

77
00:04:39.333 --> 00:04:40.640
click Add Secret.

78
00:04:40.640 --> 00:04:44.502
So I'm going to do that really quickly
off screen so I don't dox myself and

79
00:04:44.502 --> 00:04:46.480
you take care of it now.

80
00:04:46.480 --> 00:04:51.753
So the next thing I want you to add is I
want you to go to the Variables tab and

81
00:04:51.753 --> 00:04:56.000
if you notice I also have
variables that exist in my repo.

82
00:04:56.000 --> 00:04:58.560
However, you'll notice that
these variables I can read.

83
00:05:00.770 --> 00:05:06.450
So there's two ways of managing
configuration values in GitHub Actions.

84
00:05:06.450 --> 00:05:10.690
The first way is by secrets and
the second way is by variables.

85
00:05:10.690 --> 00:05:14.290
TLDR variables are unencrypted,
secrets are encrypted.

86
00:05:14.290 --> 00:05:18.200
So if you go to Secrets, you will never
see the value that you put in whereas

87
00:05:18.200 --> 00:05:21.090
normal variables you will
actually see the value.

88
00:05:21.090 --> 00:05:23.010
They're nice because at
least you can see them.

89
00:05:23.010 --> 00:05:24.290
They're a little bit easier to manage.

90
00:05:24.290 --> 00:05:26.490
So I don't try and
put everything in secrets.

91
00:05:26.490 --> 00:05:27.555
You can if you want, but

92
00:05:27.555 --> 00:05:30.500
if it doesn't actually have to be
a secret I don't recommend it.

93
00:05:30.500 --> 00:05:32.220
Just make it a variable.

94
00:05:32.220 --> 00:05:35.402
And so you'll see here that
the other two variables

95
00:05:35.402 --> 00:05:39.340
I want you to add are your account ID and
your default region.

96
00:05:39.340 --> 00:05:44.620
In this case we are using Remember US West
2, so be sure to do that.

97
00:05:45.660 --> 00:05:51.920
So you'll click New Repository variable
right here New Repository variable and

98
00:05:51.920 --> 00:05:56.920
then you'll give it AWS Account ID or
AWS Default region.

99
00:05:56.920 --> 00:05:59.155
Paste those in, add those variables and

100
00:05:59.155 --> 00:06:03.640
then you should see two new entries with
your account ID and your default region.

101
00:06:03.640 --> 00:06:06.158
And if you want to get your
account ID again you can

102
00:06:06.158 --> 00:06:10.152
do that by the top right hand corner in
the console click on your little name and

103
00:06:10.152 --> 00:06:12.437
then you should see
Account ID right there.

