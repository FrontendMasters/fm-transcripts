WEBVTT

1
00:00:00.210 --> 00:00:02.871
Man, I'm kind of excited right now,
I hope you're excited too.

2
00:00:02.871 --> 00:00:06.457
And now we're gonna increment it and
we wanna see it go to two, right?

3
00:00:06.457 --> 00:00:10.285
We're gonna, my goodness,
no, what happened here?

4
00:00:10.285 --> 00:00:17.032
Well, what happened was that we just tried
to do a state changing transaction but

5
00:00:17.032 --> 00:00:23.800
we've only provided in our code
a provider, we have not provided a signer.

6
00:00:23.800 --> 00:00:27.997
A provider tells where the network is and
basic communications.

7
00:00:27.997 --> 00:00:32.920
A signer accesses more of the wallets
kind of information and allows for

8
00:00:32.920 --> 00:00:37.844
request to be signed by whoever has
allowed this like this privileged to

9
00:00:37.844 --> 00:00:39.900
be able to use MetaMask.

10
00:00:39.900 --> 00:00:43.275
Now, obviously that part of
a blockchain is confusing.

11
00:00:43.275 --> 00:00:46.959
You can go watch a mathematician explain
to you how cryptography works, how public

12
00:00:46.959 --> 00:00:50.812
and private keys work, signing and all
that information, verifying transactions.

13
00:00:50.812 --> 00:00:53.780
For now, we're not gonna talk about
that because that's above my pay grade.

14
00:00:53.780 --> 00:00:58.712
You're just simply going to add this one
little function, getSigner, that's it.

15
00:00:58.712 --> 00:01:01.769
We have now allow, this is gonna
be when you create the provider,

16
00:01:01.769 --> 00:01:03.970
you're gonna get the signer from it.

17
00:01:03.970 --> 00:01:08.914
This is effectively stating I want
to have a provider with state

18
00:01:08.914 --> 00:01:11.816
changing transaction privileges.

19
00:01:11.816 --> 00:01:12.737
And so this is very,

20
00:01:12.737 --> 00:01:16.240
very important to have cuz now we
can do all the greatest things ever.

21
00:01:16.240 --> 00:01:19.558
And hopefully that includes
making millions of dollars,

22
00:01:19.558 --> 00:01:21.527
getting onto that yacht, right?

23
00:01:21.527 --> 00:01:22.620
Now, what Web 3 is all about?

24
00:01:22.620 --> 00:01:25.547
Yeah, money, I thought that's what
it was about, I might be mistaken.

25
00:01:25.547 --> 00:01:26.920
All right, so there we go.

26
00:01:26.920 --> 00:01:30.943
We have this, so now let's go back
to our website, let's refresh it.

27
00:01:30.943 --> 00:01:33.590
It's still at 1 because
that increment failed.

28
00:01:33.590 --> 00:01:36.704
So now, let's go, let's increment.

29
00:01:36.704 --> 00:01:39.606
And it's gonna open up MetaMask, cuz
MetaMask can be like, whoa, whoa, whoa,

30
00:01:39.606 --> 00:01:41.160
whoa, whoa, whoa, whoa.

31
00:01:41.160 --> 00:01:43.070
Are you sure you want to do this?

32
00:01:43.070 --> 00:01:45.895
Now, for anyone that's refreshed the page,
probably earlier,

33
00:01:45.895 --> 00:01:48.325
you already accepted
the permission of using MetaMask.

34
00:01:48.325 --> 00:01:50.629
I kind of have forgotten that
I accepted the permission so

35
00:01:50.629 --> 00:01:52.309
they can prompt you with that right away.

36
00:01:52.309 --> 00:01:54.992
And so now I can choose what
account do I want to use.

37
00:01:54.992 --> 00:01:58.975
Right now I'm using this account, that's
not linked to my private account, so

38
00:01:58.975 --> 00:02:01.270
it says I have no money,
insufficient funds.

39
00:02:01.270 --> 00:02:04.140
So I gotta make sure that I
have the right stuff hooked up.

40
00:02:04.140 --> 00:02:07.275
So I'm gonna reject this,
I'm gonna go in here.

41
00:02:07.275 --> 00:02:09.997
This is kind of just working with
MetaMask and development in general.

42
00:02:09.997 --> 00:02:13.352
Select the account that was
currently selected, which is look,

43
00:02:13.352 --> 00:02:16.780
notice that I have this one,
that is connected, this one isn't.

44
00:02:16.780 --> 00:02:19.172
So I'm gonna connect,
there we go, we're connected.

45
00:02:19.172 --> 00:02:23.770
I can also go in here, select ThePrimeagen
and disconnect from it, right?

46
00:02:23.770 --> 00:02:26.705
So I can go here and go disconnect,
it's no longer allowed.

47
00:02:26.705 --> 00:02:29.325
These are just using MetaMask,
you'll get used to using those.

48
00:02:29.325 --> 00:02:31.680
It's kind of, whatever, right?

49
00:02:31.680 --> 00:02:32.632
You'll figure all that stuff out.

50
00:02:32.632 --> 00:02:36.410
There we go, so now,
I have the correct one selected.

51
00:02:36.410 --> 00:02:38.816
And now, when I increment,
notice what happens.

52
00:02:38.816 --> 00:02:42.100
We have the correct one,
I now have sufficient amount of money.

53
00:02:42.100 --> 00:02:45.249
I need to pay the gas fees,
which is telling me right here,

54
00:02:45.249 --> 00:02:47.837
this is going to cost me point 0.005 eath.

55
00:02:47.837 --> 00:02:51.780
And if my math is correct,
that's like $2, right?

56
00:02:51.780 --> 00:02:52.509
That's a lot of money.

57
00:02:52.509 --> 00:02:55.810
So let's confirm,
let's increment and what happened?

58
00:02:55.810 --> 00:02:58.060
We had yet another error.

59
00:02:58.060 --> 00:03:01.397
It's almost like I have planned this,
which I have.

60
00:03:01.397 --> 00:03:03.523
All right, so let's go back to our code.

61
00:03:03.523 --> 00:03:07.227
Effectively what it's saying,
if you look right here,

62
00:03:07.227 --> 00:03:12.408
it says that the chain ID is 31337 but
we weren't expecting that, right?

63
00:03:12.408 --> 00:03:15.039
We got some other value
that was not provided.

64
00:03:15.039 --> 00:03:17.950
If we look at our node,
you'll see that it failed.

65
00:03:17.950 --> 00:03:21.933
And that's because every network has
a specific chain ID associated with it so

66
00:03:21.933 --> 00:03:25.329
you don't accidentally send
transactions to the wrong network.

67
00:03:25.329 --> 00:03:29.674
For whatever reason,
hard hat has chosen the ID of 31337,

68
00:03:29.674 --> 00:03:34.421
whereas MetaMask assumes all local
networks have the ID of 1337,

69
00:03:34.421 --> 00:03:37.970
cuz that's the generally
accepted local ID.

70
00:03:37.970 --> 00:03:41.823
So what that means is we're gonna have
to go over to our hardhat config, and

71
00:03:41.823 --> 00:03:44.101
we're gonna have to add
in something to it.

72
00:03:44.101 --> 00:03:48.757
Now, this is our first time mutating and
adding something to our hardhat config.

73
00:03:48.757 --> 00:03:53.094
It's pretty exciting, so
everyone get ready, positive attitude,

74
00:03:53.094 --> 00:03:56.118
just wait up there and
type in the word networks.

75
00:03:56.118 --> 00:03:59.300
It's an object, and
we're gonna provide hardhat.

76
00:03:59.300 --> 00:04:03.784
So when we do our local network, we're
actually talking to the hardhat network.

77
00:04:03.784 --> 00:04:06.140
I could put in things like rink B network,
and

78
00:04:06.140 --> 00:04:09.700
I could configure the rink B
network in this same area as well.

79
00:04:09.700 --> 00:04:12.481
Right now we're just doing hardhat,
which is the local one.

80
00:04:12.481 --> 00:04:16.309
And in here,
I'm gonna say the word chainId = 1337.

81
00:04:16.309 --> 00:04:22.230
We're gonna fix hardhat to become like all
other ones and have what MetaMask expects.

82
00:04:22.230 --> 00:04:23.828
I know, kinda silly, right?

83
00:04:23.828 --> 00:04:26.234
Which means we're gonna
have to go to our node.

84
00:04:26.234 --> 00:04:27.720
We're gonna have to take it down.

85
00:04:27.720 --> 00:04:30.379
I know, it's a little sad,
we've had it running for so

86
00:04:30.379 --> 00:04:33.945
long that network was beautiful,
great things happen on the network, but

87
00:04:33.945 --> 00:04:35.711
actually we've had to take it down.

88
00:04:35.711 --> 00:04:37.866
We're gonna have to restart our node,

89
00:04:37.866 --> 00:04:41.460
which means our count
contract is now gone, right?

90
00:04:41.460 --> 00:04:45.622
Right, so now we're gonna go back and
we're gonna have to run

91
00:04:45.622 --> 00:04:50.507
our deploying counter script and
get the counter back onto the network,

92
00:04:50.507 --> 00:04:54.689
cuz we had to take it down and
change its chain ID, there we go.

93
00:04:54.689 --> 00:04:57.630
Once this thing runs, I know,
there's a lot of steps to this.

94
00:04:57.630 --> 00:05:00.137
Everyone get ready for
how many steps we're gonna have to do.

95
00:05:00.137 --> 00:05:04.663
Let's go to our node and
grab out our address,

96
00:05:04.663 --> 00:05:09.419
copy that, go back to our end file,
erase that,

97
00:05:09.419 --> 00:05:13.945
paste in our new address,
go back to webpack,

98
00:05:13.945 --> 00:05:19.073
kill webpack and
now we're back hydrated, right?

99
00:05:19.073 --> 00:05:19.945
That was a lot of steps.

100
00:05:19.945 --> 00:05:23.198
These are steps, you're gonna have to
either build an environment around, or

101
00:05:23.198 --> 00:05:26.635
you're gonna have to do every single
time you're doing local development.

102
00:05:26.635 --> 00:05:30.460
It can be kind of a pain in the ass but
that's because we have so

103
00:05:30.460 --> 00:05:33.168
many separate things running all at once.

104
00:05:33.168 --> 00:05:34.335
We have our own network.

105
00:05:34.335 --> 00:05:35.559
We have our own deploying.

106
00:05:35.559 --> 00:05:37.525
We have a website that has
to communicate with it.

107
00:05:37.525 --> 00:05:41.252
It's using a provider like MetaMask.

108
00:05:41.252 --> 00:05:45.354
Do we have any questions thus far before
I go through a show, great success?

109
00:05:45.354 --> 00:05:49.880
This next part is gonna be so beautiful,
it's gonna just blow your mind, all right?

110
00:05:49.880 --> 00:05:53.020
All right, let's go here,
we're gonna refresh.

111
00:05:53.020 --> 00:05:54.910
Notice our counters back at one.

112
00:05:54.910 --> 00:05:57.526
We can now increment it here,
I'll make it a little bit bigger, so

113
00:05:57.526 --> 00:05:58.429
it's just exciting.

114
00:05:58.429 --> 00:06:02.990
We're gonna increment, it's gonna ask
us again, do you want to pay for this?

115
00:06:02.990 --> 00:06:04.974
Yes, we do want to pay for it.

116
00:06:04.974 --> 00:06:06.690
And then of course, what happens?

117
00:06:06.690 --> 00:06:08.238
Nonce it's too high.

118
00:06:08.238 --> 00:06:09.482
What happened here?

119
00:06:09.482 --> 00:06:13.096
When you're developing with MetaMask,
this can happen from time to time and

120
00:06:13.096 --> 00:06:15.630
the first time it happened,
it was terrifying.

121
00:06:15.630 --> 00:06:19.718
So saying nonce too high,
expected to but got 50.

122
00:06:19.718 --> 00:06:22.844
This means last night while I
was practicing to do this today,

123
00:06:22.844 --> 00:06:26.269
I had this account hooked up and
I made several, several requests,

124
00:06:26.269 --> 00:06:29.630
which does cost my nonce to get higher and
higher and higher.

125
00:06:29.630 --> 00:06:33.342
And now it's out of sync with the network,
cuz I just created a new network yet

126
00:06:33.342 --> 00:06:35.014
I've already assumed it exists.

127
00:06:35.014 --> 00:06:37.626
So now that we're doing a state
changing transaction saying, hey,

128
00:06:37.626 --> 00:06:38.770
you can't do that.

129
00:06:38.770 --> 00:06:42.074
So fun little fact, you could go look
this up, you'd eventually run into it.

130
00:06:42.074 --> 00:06:48.955
But you click on to this, go to Settings,
go to Advanced, Reset Account.

131
00:06:48.955 --> 00:06:51.451
It resets your nonces, so
everything just will work.

132
00:06:51.451 --> 00:06:55.362
You will run into this all the time doing
local development as you take down and

133
00:06:55.362 --> 00:06:57.020
put back up your networks.

134
00:06:57.020 --> 00:07:00.128
I know, there's so
many little steps that have to be done.

135
00:07:00.128 --> 00:07:03.189
It's kinda like terrifying how many
steps actually have to be done to

136
00:07:03.189 --> 00:07:04.155
get something done.

137
00:07:04.155 --> 00:07:08.058
It's just a part of
the beautiful life of Web 3.

138
00:07:08.058 --> 00:07:11.523
All right,
let's increment again, let's go.

139
00:07:11.523 --> 00:07:14.329
Now, wait for it, wait for it,
it's gonna happen, Confirm.

140
00:07:17.030 --> 00:07:21.207
But it didn't show anything.

141
00:07:21.207 --> 00:07:22.051
Does anyone have any
idea what's happening?

142
00:07:24.348 --> 00:07:28.020
This is me seeding, don't worry,
I know what's happening.

143
00:07:28.020 --> 00:07:31.651
All right, so the first thing
you'll notice is that we did it,

144
00:07:31.651 --> 00:07:35.675
we got no new errors at this point,
but nothing happened, right?

145
00:07:35.675 --> 00:07:37.022
Whoa, whoa, did you just see that?

146
00:07:37.022 --> 00:07:39.620
What is this?
It says transaction to confirm.

147
00:07:39.620 --> 00:07:42.675
Wow, that happened a lot later, didn't it?

148
00:07:42.675 --> 00:07:46.376
That means, we sent off a request
that took some time, and

149
00:07:46.376 --> 00:07:49.110
then it came back, and then it completed.

150
00:07:49.110 --> 00:07:52.417
So I bet if I refresh this it will,
my goodness, look at that.

151
00:07:52.417 --> 00:07:57.539
We did actually increment the counter,
it just took a little bit, right?

152
00:07:57.539 --> 00:08:01.810
That makes perfect sense, cuz that
is how it's always going to happen.

153
00:08:01.810 --> 00:08:06.833
So let's go back to our
little beautiful typescript.

154
00:08:06.833 --> 00:08:12.108
And so what comes out of here when you
have this await you are not awaiting for

155
00:08:12.108 --> 00:08:14.216
this transaction to be done.

156
00:08:14.216 --> 00:08:18.543
But actually you're waiting for
the transaction to be set in.

157
00:08:18.543 --> 00:08:25.802
So now, what I can do is I can like
this const tx = await tx.wait.

158
00:08:25.802 --> 00:08:31.936
Now, this will wait for the transaction to
be done and then I can call the counter.

159
00:08:31.936 --> 00:08:36.780
Just to prove it to you I'll go back over
here refresh it hit that increment allow

160
00:08:36.780 --> 00:08:39.220
it to happen, confirm, there we go.

161
00:08:39.220 --> 00:08:42.729
It happened to go through right away
this time, just lock up the network and

162
00:08:42.729 --> 00:08:44.019
everything went through.

163
00:08:44.019 --> 00:08:47.333
Increment it again, just in case you don't
believe me, hopefully I don't get so

164
00:08:47.333 --> 00:08:49.450
fast one, every now and
then I get these fast ones.

165
00:08:49.450 --> 00:08:50.751
Okay, it's fast now.

166
00:08:50.751 --> 00:08:52.815
I don't know what happened,
it's going really, really fast.

167
00:08:52.815 --> 00:08:55.590
But this would have worked
if it was nice and slow.

