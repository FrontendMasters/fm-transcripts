WEBVTT

1
00:00:00.099 --> 00:00:01.833
Let's try to get this deployed then.

2
00:00:01.833 --> 00:00:05.747
Let's see what happens with that.

3
00:00:05.747 --> 00:00:07.655
So I need to make a new repo for

4
00:00:07.655 --> 00:00:11.727
that because this repo has on Main,
the other finished app.

5
00:00:11.727 --> 00:00:14.034
Well, I guess I could use my finished app.

6
00:00:14.034 --> 00:00:21.423
Now, I'm gonna use the same app
we all have, always consistent.

7
00:00:21.423 --> 00:00:26.444
I'm going to repel just
connect it right click,

8
00:00:26.444 --> 00:00:30.862
come here, I don't you work, thank you.

9
00:00:30.862 --> 00:00:37.557
So this will be AI,
full stack the something like that.

10
00:00:43.029 --> 00:00:52.166
Copy that, And I'm just gonna paste that.

11
00:00:52.166 --> 00:00:56.783
Wait, I need to not call it origin.

12
00:00:56.783 --> 00:01:03.742
I forgot I already have something here,
I will call this, let me see.

13
00:01:03.742 --> 00:01:05.390
I kind of already did it.

14
00:01:05.390 --> 00:01:06.824
&gt;&gt; I did it.

15
00:01:06.824 --> 00:01:08.489
&gt;&gt; Okay, I think it worked out.

16
00:01:08.489 --> 00:01:13.705
So I'll just call this,
I don't know, deploy I guess.

17
00:01:20.581 --> 00:01:26.244
Pick it up, it's already there, great.

18
00:01:26.244 --> 00:01:29.063
Alright, so I have all my stuff here.

19
00:01:29.063 --> 00:01:32.632
No, what's in here?

20
00:01:32.632 --> 00:01:33.840
Okay, that's not bad.

21
00:01:33.840 --> 00:01:35.626
I'll say no.

22
00:01:35.626 --> 00:01:38.113
Why'd you put my ENV in there?

23
00:01:38.113 --> 00:01:41.678
That's fine.

24
00:01:41.678 --> 00:01:42.860
Okay, let's deploy this.

25
00:01:42.860 --> 00:01:44.708
So we're gonna use Vercel to deploy this.

26
00:01:44.708 --> 00:01:48.861
So you just head over to vercel.com,
make an account.

27
00:01:48.861 --> 00:01:53.552
I have so many things here,
once you make an account,

28
00:01:53.552 --> 00:01:57.741
also make sure you push
your thing up to GitHub.

29
00:01:57.741 --> 00:02:01.577
You can't deploy to Vercel unless
your project is on GitHub.

30
00:02:01.577 --> 00:02:04.330
I think you can with a CLI, but we're
just going to do it through GitHub, so

31
00:02:04.330 --> 00:02:04.870
much easier.

32
00:02:10.300 --> 00:02:15.236
I'm going to add a new project, and
my stuff has already connected.

33
00:02:15.236 --> 00:02:17.752
You can see 50 seconds ago
it saw that I had this app.

34
00:02:17.752 --> 00:02:22.752
So I'm just going to import that app, so

35
00:02:22.752 --> 00:02:26.733
it sees that it's a next JS app.

36
00:02:26.733 --> 00:02:28.579
I can change the name of it if I want.

37
00:02:28.579 --> 00:02:33.504
Root directory is the root,
I don't have to change anything there.

38
00:02:33.504 --> 00:02:36.194
I'm going to change the bill command
that I found out the other day.

39
00:02:36.194 --> 00:02:41.155
You're gonna have to do Prisma or

40
00:02:41.155 --> 00:02:44.698
MPX Prisma generate and

41
00:02:44.698 --> 00:02:48.783
then do a next build, why?

42
00:02:48.783 --> 00:02:50.212
There's a whole article
about it somewhere.

43
00:02:50.212 --> 00:02:51.511
I don't know why I didn't even read it.

44
00:02:51.511 --> 00:02:54.801
I was just mad that I had to do it.

45
00:02:54.801 --> 00:02:58.016
So we got to generate that first, and
then we can do the next builds, and

46
00:02:58.016 --> 00:02:59.418
then environment variables.

47
00:02:59.418 --> 00:03:03.168
So, yeah, you probably want to go into
clerk, switch it over to production mode,

48
00:03:03.168 --> 00:03:05.327
because by default,
clerk is in like dev mode.

49
00:03:05.327 --> 00:03:08.085
All right, you can see right here,
it says development.

50
00:03:08.085 --> 00:03:14.161
You can switch over to production and
get the production stuff.

51
00:03:14.161 --> 00:03:16.189
I think and I see.

52
00:03:19.342 --> 00:03:20.565
That's really cool.

53
00:03:20.565 --> 00:03:26.099
You can clone the development instance
to production, that is great.

54
00:03:26.099 --> 00:03:29.649
But actually, I think the development
will work in production for this example.

55
00:03:29.649 --> 00:03:32.896
If not we'll make a production would I
think it'll work, I don't think cares or

56
00:03:32.896 --> 00:03:34.297
knows that you're on localhost.

57
00:03:34.297 --> 00:03:38.723
So, I think we're fine, but in a real
world you would go to production, so

58
00:03:38.723 --> 00:03:42.453
you're not mixing development
users with production users,

59
00:03:42.453 --> 00:03:44.306
that would be the main reason.

60
00:03:44.306 --> 00:03:47.091
But as far as the functionality,
I'm pretty sure it's the same.

61
00:03:47.091 --> 00:03:50.371
So she'll be good.

62
00:03:50.371 --> 00:03:54.476
And then OpenAI keys is good.

63
00:03:54.476 --> 00:04:01.311
The only thing we would need to change
would be our PlanetScale database,

64
00:04:01.311 --> 00:04:05.403
we want to go get that,
so let's go do that.

65
00:04:05.403 --> 00:04:09.766
So PlanetScale database,

66
00:04:09.766 --> 00:04:13.942
I am on this one I believe.

67
00:04:13.942 --> 00:04:15.961
So we've got to do a few
things with this one, and

68
00:04:15.961 --> 00:04:18.729
that's because we probably don't
have a production branch yet.

69
00:04:18.729 --> 00:04:22.265
You had a main branch, but
you didn't designate that for production.

70
00:04:22.265 --> 00:04:23.619
So we're gonna do a few things.

71
00:04:23.619 --> 00:04:27.278
If you go there, you'll see this thing
that says, promote to production.

72
00:04:27.278 --> 00:04:30.415
If you're on the main branch, we do.

73
00:04:30.415 --> 00:04:33.155
We want to promote this to production,
so let's do that.

74
00:04:33.155 --> 00:04:36.435
We need a production branch, so
we'll promote that to production.

75
00:04:36.435 --> 00:04:38.390
That is now the production branch.

76
00:04:38.390 --> 00:04:42.325
So on the production branch, we have to
make something called safe migrations.

77
00:04:44.923 --> 00:04:48.324
Okay, I will enable safe
migrations on this branch.

78
00:04:48.324 --> 00:04:50.845
This means protect this
branch from accidental and

79
00:04:50.845 --> 00:04:52.670
dangerous schema changes enabled.

80
00:04:52.670 --> 00:04:56.128
Deploy requests, schema reverts,
gated deploys, and data loss warnings.

81
00:04:56.128 --> 00:04:59.857
I thought you got that for
free automatically on production,

82
00:04:59.857 --> 00:05:02.018
but I guess you could not have that.

83
00:05:02.018 --> 00:05:05.728
But if you turn it off,
you can't deploy anything to it anyway.

84
00:05:05.728 --> 00:05:06.370
I don't know.

85
00:05:06.370 --> 00:05:09.237
That should just be on, I guess.

86
00:05:10.705 --> 00:05:14.754
All right,
now let's make a deploy request.

87
00:05:14.754 --> 00:05:20.734
So, we'll go to branches, we'll click on
my dev branch or whatever your branch is.

88
00:05:20.734 --> 00:05:22.188
You will deploy to me.

89
00:05:22.188 --> 00:05:27.860
You can add in some information,
yo, merge,

90
00:05:27.860 --> 00:05:33.101
merge this, and create a deploy request.

91
00:05:33.101 --> 00:05:35.296
Should be fine, there's literally
nothing on the main branch, so

92
00:05:35.296 --> 00:05:36.496
it should just go straight in there.

93
00:05:36.496 --> 00:05:38.646
There's no conflicts.

94
00:05:38.646 --> 00:05:43.735
It's making a deploy request,
which I think it already did.

95
00:05:43.735 --> 00:05:45.223
It's just timed out.

96
00:05:45.223 --> 00:05:46.420
I'll deploy these changes.

97
00:05:50.033 --> 00:05:52.252
It's staging them first,
this is really cool.

98
00:05:52.252 --> 00:05:53.666
For a database?

99
00:05:53.666 --> 00:05:54.998
This is kind of insane.

100
00:05:58.603 --> 00:06:00.467
There's a schema revert.

101
00:06:00.467 --> 00:06:04.764
Man, I know people who lost
their jobs from bad migrations,

102
00:06:04.764 --> 00:06:06.962
would have loved to have that.

103
00:06:06.962 --> 00:06:09.323
[LAUGH] All right, so there we go.

104
00:06:09.323 --> 00:06:14.516
We now have our schema on Production,

105
00:06:14.516 --> 00:06:18.745
so now let's connect to that.

106
00:06:18.745 --> 00:06:24.204
So now I can connect to the database and
you will have to create a user here,

107
00:06:24.204 --> 00:06:27.481
so I'm going to connect
to the main branch.

108
00:06:27.481 --> 00:06:28.823
Here's my password.

109
00:06:28.823 --> 00:06:32.519
Go ahead, steal my password and
everything if you want.

110
00:06:32.519 --> 00:06:35.179
[LAUGH] And here's my connection string.

111
00:06:35.179 --> 00:06:38.658
So this is the connection
string I'm going to use.

112
00:06:38.658 --> 00:06:40.984
You can see I have Prisma selected.

113
00:06:40.984 --> 00:06:43.737
So I'm just going to copy that.

114
00:06:43.737 --> 00:06:45.737
We're going to go back to the Vercel.

115
00:06:45.737 --> 00:06:49.797
Sweet thing about Vercel, if you just go
into one of the environment variable names

116
00:06:49.797 --> 00:06:52.931
with your whole environment
variable equals the value copied.

117
00:06:52.931 --> 00:06:58.616
And you paste, it'll put them in both of
these for you automatically, like that.

118
00:06:58.616 --> 00:07:04.677
Pretty far, I know that's the best
thing about this app is that okay,

119
00:07:04.677 --> 00:07:08.596
other environment
variables we need to add.

120
00:07:08.596 --> 00:07:12.301
Let me see, don't be looking at my stuff.

121
00:07:12.301 --> 00:07:16.481
[LAUGH] I'm gonna add all this stuff.

122
00:07:16.481 --> 00:07:17.728
I'm gonna copy this.

123
00:07:17.728 --> 00:07:19.595
I'm gonna just, wait,
will it do all of them?

124
00:07:19.595 --> 00:07:23.039
No, it won't.

125
00:07:23.039 --> 00:07:26.410
It did, that's crazy.

126
00:07:26.410 --> 00:07:30.025
This is really cool because I spent,
man, I was working on my startup.

127
00:07:30.025 --> 00:07:34.706
We had like a hundred
environment variables now,

128
00:07:34.706 --> 00:07:39.841
which is doing that in Heroku was so
bad, it was so bad.

129
00:07:39.841 --> 00:07:44.677
Okay, and then my open AI key,

130
00:07:44.677 --> 00:07:49.337
I think that's everything.

131
00:07:49.337 --> 00:07:50.269
I think we're good.

132
00:07:50.269 --> 00:07:53.675
I don't have anything in here other
than that which we don't need so,

133
00:07:55.434 --> 00:07:57.618
I think we're good here.

134
00:07:57.618 --> 00:08:03.583
Okay, let's hit that button and
see what happens.

135
00:08:06.956 --> 00:08:12.786
I mean, the in-memory vector
store in theory should work.

136
00:08:12.786 --> 00:08:16.641
I mean, it will work if you deploy this
to like a non-serverless environment, but

137
00:08:16.641 --> 00:08:18.802
I just don't know how
it works in serverless.

138
00:08:18.802 --> 00:08:23.416
It depends on the resources you have,
but at the end of the day,

139
00:08:23.416 --> 00:08:27.003
it's just like an object,
so it should be fine.

140
00:08:27.003 --> 00:08:30.289
It's not like writing to a file,
you couldn't use SQLite here,

141
00:08:30.289 --> 00:08:32.879
because you don't have
access to the file system.

142
00:08:32.879 --> 00:08:35.244
But, I don't know, let's see,
let's watch it build.

143
00:08:35.244 --> 00:08:35.933
It's gonna break.

144
00:08:35.933 --> 00:08:41.604
I just remembered we forgot to turn off
the TypeScript and ESLint warnings.

145
00:08:41.604 --> 00:08:42.270
It's 100% gonna break.

146
00:08:42.270 --> 00:08:47.099
I'm just gonna go ahead and do that
right now because I know it's happening.

147
00:08:47.099 --> 00:08:50.075
I already know it's about to happen.

148
00:08:50.075 --> 00:08:54.624
So you can go to your next config,

149
00:08:54.624 --> 00:08:58.847
and you can say, TypeScript,

150
00:08:58.847 --> 00:09:04.045
you can say ignore build errors true,

151
00:09:04.045 --> 00:09:06.968
and then you can say,

152
00:09:06.968 --> 00:09:11.691
ESLint ignore build errors true.

153
00:09:11.691 --> 00:09:15.931
There's another one that says just
ignored completely during builds.

154
00:09:15.931 --> 00:09:18.959
I guess it means it just won't even run.

155
00:09:18.959 --> 00:09:22.182
Yeah, how about both of those?

156
00:09:22.182 --> 00:09:25.330
[LAUGH]
&gt;&gt; Security in depth?

157
00:09:25.330 --> 00:09:29.170
&gt;&gt; Yeah, exactly.

158
00:09:29.170 --> 00:09:34.347
Push to Deploy and
I would probably just, yeah,

159
00:09:34.347 --> 00:09:39.791
look, this thing's like no,
what are you doing?

160
00:09:39.791 --> 00:09:45.010
Yeah, I freaked out on the first

161
00:09:45.010 --> 00:09:50.617
typescript thing is ID implicitly

162
00:09:50.617 --> 00:09:54.883
has any, okay, I get it.

163
00:09:54.883 --> 00:09:58.579
You want me to use it, I get it no,

164
00:09:58.579 --> 00:10:03.210
I gotta add those all again that's fine.

165
00:10:03.210 --> 00:10:08.896
It's really easy to do, so
we'll just go to ENV again.

166
00:10:08.896 --> 00:10:15.631
I can now I feel confident I
can just copy all of these,

167
00:10:15.631 --> 00:10:22.519
paste that in there,
make sure I have this overwritten

168
00:10:22.519 --> 00:10:27.267
to MPX Prisma generates and that,
&gt;&gt; Did you

169
00:10:27.267 --> 00:10:31.183
mean to put a couple of random characters
in the project name at the top?

170
00:10:31.183 --> 00:10:32.567
Would you like to have passed it?

171
00:10:32.567 --> 00:10:33.486
&gt;&gt; Yeah, I didn't need to do that.

172
00:10:33.486 --> 00:10:34.447
Thank you.

173
00:10:34.447 --> 00:10:37.671
I would have been like, well,
I don't know how they got there,

174
00:10:37.671 --> 00:10:39.186
that would have threw me off.

175
00:10:39.186 --> 00:10:44.473
And then database your URL,

176
00:10:44.473 --> 00:10:48.667
one more time, cool.

177
00:10:48.667 --> 00:10:52.333
Now, we'll try to play this.

178
00:10:52.333 --> 00:10:53.799
It already exists.

179
00:10:53.799 --> 00:10:55.018
I deployed it?

180
00:10:55.018 --> 00:10:57.801
I was gonna do another name.

181
00:10:57.801 --> 00:11:03.952
Yeah.
How about that?

182
00:11:03.952 --> 00:11:06.827
Okay, now let's see what happens,
should be good here.

183
00:11:06.827 --> 00:11:08.156
You can also test this locally, right?

184
00:11:08.156 --> 00:11:10.255
You can just find it.

185
00:11:10.255 --> 00:11:13.311
You can build this with npx run build, but

186
00:11:13.311 --> 00:11:18.302
you still won't get the same
environment that you get from Vercel.

187
00:11:18.302 --> 00:11:21.441
So Vercel lets you pull down
environment variables that you have and

188
00:11:21.441 --> 00:11:23.658
you can run it from there and
it's a true thing.

189
00:11:23.658 --> 00:11:28.596
But I know it builds,
I just don't know if it

190
00:11:28.596 --> 00:11:33.570
will run [LAUGH] That's the difference.

191
00:11:33.570 --> 00:11:37.136
But I mean as you can see it does
the same thing that we would do, right?

192
00:11:37.136 --> 00:11:42.816
It will do NPM install,
you can see it generated

193
00:11:42.816 --> 00:11:48.212
the Prisma client and
now it is doing a build.

194
00:11:48.212 --> 00:11:53.040
Let's see, what is this?

195
00:11:53.040 --> 00:11:54.174
Did this break?

196
00:11:54.174 --> 00:11:55.020
No, it didn't break.

197
00:11:55.020 --> 00:11:57.445
I don't know why it's
logging all that stuff out.

198
00:11:57.445 --> 00:12:00.045
This is a good sign, that means it built.

199
00:12:00.045 --> 00:12:03.999
If you've never seen an XJS output before,
every time you see one of these icons or

200
00:12:03.999 --> 00:12:05.962
these little logos, that's a lambda.

201
00:12:05.962 --> 00:12:08.006
That means this route is dynamic,

202
00:12:08.006 --> 00:12:11.397
as in every time someone goes to it,
it will be executed.

203
00:12:11.397 --> 00:12:15.007
If you see a circle next to it, that
means this route is static, it's cash.

204
00:12:15.007 --> 00:12:17.625
It's just gonna be served from a CDN,
basically.

205
00:12:17.625 --> 00:12:20.389
So that's what that means.

206
00:12:20.389 --> 00:12:22.680
And hey, look at that.

207
00:12:22.680 --> 00:12:23.913
&gt;&gt; [LAUGH]
&gt;&gt; Looks deployed.

208
00:12:23.913 --> 00:12:27.603
Let's go see what broke.

209
00:12:27.603 --> 00:12:30.921
So [LAUGH] Let's see if this works.

210
00:12:30.921 --> 00:12:32.604
My god, it works.

211
00:12:35.327 --> 00:12:36.983
Wow, sign up actually works.

212
00:12:36.983 --> 00:12:38.449
I didn't think the sign up is gonna work.

213
00:12:45.179 --> 00:12:46.137
Wow, that worked well.

214
00:12:46.137 --> 00:12:48.436
Hey, we're in, we're cooking with grease.

215
00:12:48.436 --> 00:12:51.344
Okay, let's test some of the AI stuff.

216
00:12:51.344 --> 00:12:53.823
So, click new entry

217
00:12:56.978 --> 00:13:02.269
Give that a minute, come on.

218
00:13:02.269 --> 00:13:04.551
I know you wanna make a new entry, so

219
00:13:04.551 --> 00:13:09.129
this is where we can go check out
the logs to see why this isn't working.

220
00:13:09.129 --> 00:13:11.169
All right, let's refresh it.

221
00:13:11.169 --> 00:13:12.685
I knew it was there.

222
00:13:12.685 --> 00:13:16.153
Okay, got that messed up.

223
00:13:16.153 --> 00:13:17.363
Where did I mess up?

224
00:13:17.363 --> 00:13:20.743
Okay, no, there's some error
here on the client side.

225
00:13:20.743 --> 00:13:27.173
It says, What?

226
00:13:27.173 --> 00:13:28.610
That's weird.

227
00:13:28.610 --> 00:13:30.457
&gt;&gt; I don't know if it's relevant, but

228
00:13:30.457 --> 00:13:34.519
I've been getting that error on the
Next.js documentation, a decent amount.

229
00:13:34.519 --> 00:13:37.659
I wonder if it is Versal side.

230
00:13:37.659 --> 00:13:41.414
&gt;&gt; I mean,
it's definitely in vendor somewhere.

231
00:13:41.414 --> 00:13:45.784
So this looks like Clark, though.

232
00:13:45.784 --> 00:13:47.363
Looks like something to do with Clark.

233
00:13:47.363 --> 00:13:51.140
Might be a Clark thing.

234
00:13:51.140 --> 00:13:55.580
That's weird, maybe we do have
to switch to Clark production.

235
00:13:55.580 --> 00:14:00.905
I don't know, that is weird, but
let's test some of the AI stuff.

236
00:14:00.905 --> 00:14:03.805
What was my mood?

237
00:14:10.926 --> 00:14:13.978
Because we do have that one in there,
and now there's like a default thing.

238
00:14:15.037 --> 00:14:19.571
What do you mean?

239
00:14:19.571 --> 00:14:20.559
So it is working.

240
00:14:20.559 --> 00:14:21.679
I guess it's not pulling this one in.

241
00:14:21.679 --> 00:14:26.823
Okay, what has my mood been like,

242
00:14:31.391 --> 00:14:36.740
From the last entry.

243
00:14:36.740 --> 00:14:39.604
That's good, though, that that's working.

244
00:14:39.604 --> 00:14:43.705
Okay, I don't know why that's not pulling
that in, and then that page is broke.

245
00:14:43.705 --> 00:14:45.320
All right, so it's halfway there.

246
00:14:45.320 --> 00:14:48.449
It's kind of what I thought was going
to happen, that it would deploy but

247
00:14:48.449 --> 00:14:49.590
maybe not run all the way.

248
00:14:49.590 --> 00:14:53.682
So it looks like either there's some
errors going on with server components or

249
00:14:53.682 --> 00:14:56.538
something to do with Clerk and
switching over to prod.

250
00:14:56.538 --> 00:14:59.160
Either way, that's how you deploy it,
and then to fix it,

251
00:14:59.160 --> 00:15:02.569
you would just have to go back and forth,
playing around with these errors and

252
00:15:02.569 --> 00:15:04.209
deploying it until you got it right.

253
00:15:04.209 --> 00:15:04.709
So,

