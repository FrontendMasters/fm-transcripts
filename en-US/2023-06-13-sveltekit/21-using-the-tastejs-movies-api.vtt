WEBVTT

1
00:00:00.408 --> 00:00:05.991
So we're gonna create a new route
inside our source/routes directory,

2
00:00:05.991 --> 00:00:11.586
which is gonna be called movies/, and
then view is a dynamic parameter.

3
00:00:13.823 --> 00:00:20.032
And inside that,
we can create a page.svelte component.

4
00:00:20.032 --> 00:00:26.996
And we're gonna be loading some data,
so we'll add a page.ts as well.

5
00:00:33.248 --> 00:00:37.040
Now we can actually do one better
than having a dynamic parameter here.

6
00:00:37.040 --> 00:00:42.128
Because we've defined which views
are valid, trending, now playing,

7
00:00:42.128 --> 00:00:47.380
and upcoming, we can use a route matcher
so that this view dynamic parameter

8
00:00:47.380 --> 00:00:51.908
is not matched for anything that
is not one of those three things.

9
00:00:51.908 --> 00:00:56.380
So the way that we do that is we
create a matcher inside source/params.

10
00:01:03.580 --> 00:01:08.544
We'll create a new matcher,
I'll call it list.ts.

11
00:01:08.544 --> 00:01:12.541
And you'll remember that we need to export
a match function which is gonna return

12
00:01:12.541 --> 00:01:15.318
true if the parameter matches and
false if it doesn't.

13
00:01:26.685 --> 00:01:29.773
And if we return param,

14
00:01:33.902 --> 00:01:37.132
In views, which we just import like that,

15
00:01:37.132 --> 00:01:41.708
then this is gonna return true
if the parameter is trending,

16
00:01:41.708 --> 00:01:46.482
now playing, or upcoming, but
false if it's anything else.

17
00:01:46.482 --> 00:01:49.298
Now that we've got that,
we can add that to the parameter here.

18
00:01:49.298 --> 00:01:53.439
Just rename that directory view=list.

19
00:01:56.678 --> 00:02:00.988
And now if we go to /movies/trending,
the page exists.

20
00:02:00.988 --> 00:02:04.772
If we change that in any way,
like trendingx,

21
00:02:04.772 --> 00:02:08.372
then it's a 404, it no longer matches.

22
00:02:08.372 --> 00:02:12.620
This gives us some confidence when we're
building our data loading logic that we

23
00:02:12.620 --> 00:02:14.872
are, in fact, dealing with a valid view.

24
00:02:14.872 --> 00:02:19.717
&gt;&gt; Sorry if I missed it, but is there any
reason you would wanna do it this way

25
00:02:19.717 --> 00:02:24.020
versus just making three routes for
trending, playing, etc?

26
00:02:25.250 --> 00:02:26.850
&gt;&gt; Yeah, so the question was,

27
00:02:26.850 --> 00:02:31.460
why are we creating a dynamic parameter
instead of just repeating the directory?

28
00:02:31.460 --> 00:02:33.472
And the answer is that these
pages are essentially the same.

29
00:02:33.472 --> 00:02:36.736
They're using the same component,
they're using the same logic.

30
00:02:36.736 --> 00:02:41.226
And we could do it by just reusing
components in three separate files.

31
00:02:41.226 --> 00:02:45.520
But then if we add a new view,
like the most popular movies, or

32
00:02:45.520 --> 00:02:49.748
the top rated movies,
then we got to keep duplicating code.

33
00:02:49.748 --> 00:02:51.909
And if we do it this way instead,

34
00:02:51.909 --> 00:02:55.445
then it allows us to express
those things just once.

35
00:02:55.445 --> 00:03:00.793
It's also, for the sake of the workshop,
it's a good opportunity to use

36
00:03:00.793 --> 00:03:06.590
more SvelteKit features, and that's
the main reason, if I'm honest, yes.

37
00:03:06.590 --> 00:03:12.306
&gt;&gt; Do you need to remove
the three awaits in the promise?

38
00:03:12.306 --> 00:03:16.152
&gt;&gt; Yes, all right, so
thank you to whoever noticed that.

39
00:03:16.152 --> 00:03:20.816
After removing the waterfall
in our route load function,

40
00:03:20.816 --> 00:03:27.401
we actually did no such thing, because
we're still awaiting the API calls here.

41
00:03:27.401 --> 00:03:31.437
We need to get rid of each of these,
like that.

42
00:03:31.437 --> 00:03:36.204
Although this is now erroring because
we're not returning a movie list from

43
00:03:36.204 --> 00:03:40.013
the fetch call,
we're returning a promise of a movie list.

44
00:03:40.013 --> 00:03:43.523
So we need to get each of these and

45
00:03:43.523 --> 00:03:47.687
just wrap that in a promise like that.

46
00:03:47.687 --> 00:03:50.437
And now,
because we're awaiting all of these,

47
00:03:50.437 --> 00:03:53.329
trending has the correct
type again of MovieList.

48
00:03:53.329 --> 00:03:57.317
Thank you to whoever noticed that
in the chat, that's very helpful.

