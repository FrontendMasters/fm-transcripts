WEBVTT

1
00:00:00.248 --> 00:00:04.229
All right, I'm gonna remove that logging,
we no longer need it.

2
00:00:04.229 --> 00:00:06.036
we've verified that we are in
fact getting cache hits.

3
00:00:06.036 --> 00:00:09.419
So we're just going to delete that and
delete that.

4
00:00:13.425 --> 00:00:18.754
Okay, let's add a search page that we can
search for movies that are interested in.

5
00:00:20.083 --> 00:00:27.444
You know the score by now, we create a new
directory inside here, call it search.

6
00:00:28.510 --> 00:00:32.869
And inside there we'll create

7
00:00:32.869 --> 00:00:37.398
a page.ts and a page.svelte.

8
00:00:40.007 --> 00:00:43.816
And we'll add a load
function in our page.ts file

9
00:00:49.324 --> 00:00:53.104
And we're gonna be using the URL object
because we're gonna to need to grab

10
00:00:53.104 --> 00:00:54.244
the query parameter.

11
00:01:13.226 --> 00:01:17.618
And if the query parameter isn't
specified, then we'll just assume that

12
00:01:17.618 --> 00:01:22.631
someone has come direct to the search page
and they haven't yet performed a search.

13
00:01:22.631 --> 00:01:28.029
So we're gonna return
an empty array of movies.

14
00:01:39.331 --> 00:01:43.185
I'm also gonna pass the empty
string back to them.

15
00:01:43.185 --> 00:01:45.932
But if they have specified a query,

16
00:01:45.932 --> 00:01:50.520
then we're gonna make an API request,
cons data = await.

17
00:01:50.520 --> 00:01:53.571
And we need to import our API helper.

18
00:01:53.571 --> 00:01:57.900
Import * as api from lib/api.

19
00:02:01.565 --> 00:02:05.434
We've got to pass in our fetch so
let's grab that.

20
00:02:08.543 --> 00:02:12.743
And the endpoint this
time is search/movie.

21
00:02:14.600 --> 00:02:18.710
And we're gonna pass that
query direct to the API.

22
00:02:18.710 --> 00:02:21.259
And this is gonna give us
back another movie list.

23
00:02:24.267 --> 00:02:28.074
You can see that it's also imported
that from type declarations.

24
00:02:30.794 --> 00:02:35.316
So we'll return the query so that we
can render that in the search input.

25
00:02:37.390 --> 00:02:42.555
And the movies are the results
array from the data object.

26
00:02:47.340 --> 00:02:53.662
Inside our search page, We're

27
00:02:53.662 --> 00:02:59.407
gonna add a div class = column.

28
00:02:59.407 --> 00:03:04.073
And at the very top, we'll just
have a big title that says Search.

29
00:03:06.224 --> 00:03:09.566
So let's go over to our
in-progress search page.

30
00:03:17.496 --> 00:03:22.660
And also the if there was a query
that was made, we need to create

31
00:03:22.660 --> 00:03:27.833
our script tag so that we can
access the data that was passed in.

32
00:03:27.833 --> 00:03:32.164
Remember lang = ts, export let data,

33
00:03:32.164 --> 00:03:39.008
I dn't know what's going on with
my typing skills right now.

34
00:03:39.008 --> 00:03:41.090
Data query was provided.

35
00:03:45.629 --> 00:03:49.404
Then we're gonna use that results page
component that we've been using so far.

36
00:03:51.166 --> 00:03:53.295
Pass it the movies.

37
00:03:56.906 --> 00:04:01.856
And we're gonna give it a next
attribute of null for now.

38
00:04:06.004 --> 00:04:10.203
And obviously, because we don't
have a query at this point,

39
00:04:10.203 --> 00:04:12.640
we don't have anything to render.

40
00:04:12.640 --> 00:04:15.847
In theory,
if I add a query like Avatar now,

41
00:04:15.847 --> 00:04:20.009
it is in fact performing a search and
rendering that, but

42
00:04:20.009 --> 00:04:24.885
we wanna have some user interface
that allows us to edit the query.

43
00:04:24.885 --> 00:04:28.308
So let's create a form element.

44
00:04:28.308 --> 00:04:32.297
Unlike the other forms that we've been
using in this workshop, we're not

45
00:04:32.297 --> 00:04:36.687
using method = post this time because this
is just gonna reload the current page.

46
00:04:36.687 --> 00:04:39.277
It's not mutating any data or
anything like that,

47
00:04:39.277 --> 00:04:41.273
it's just making a request at the API.

48
00:04:41.273 --> 00:04:45.998
So we'll omit the method and
we'll omit the action,

49
00:04:45.998 --> 00:04:50.303
but we'll add an input,
give it a name, query,

50
00:04:50.303 --> 00:04:55.765
because that's going to correspond
to the query parameter.

51
00:04:58.079 --> 00:05:05.773
We'll initialize it with any query
that was previously added like this.

52
00:05:05.773 --> 00:05:10.567
I'm gonna disable autocomplete and
I'm gonna disable the spellcheck.

53
00:05:10.567 --> 00:05:15.513
Otherwise, it's gonna complain about

54
00:05:15.513 --> 00:05:21.874
the spellings of movies And
hopefully, find now search for

55
00:05:21.874 --> 00:05:26.653
star wars, it's gonna go away,
it's gonna perform an API request,

56
00:05:26.653 --> 00:05:31.360
and it's gonna update the page in
place without reloading the page.

57
00:05:31.360 --> 00:05:33.506
So unlike a form method = post,

58
00:05:33.506 --> 00:05:38.290
form method = get is gonna default
to doing everything client-side.

59
00:05:38.290 --> 00:05:41.103
We're not gonna reload the page
to get those new results.

60
00:05:41.103 --> 00:05:43.716
Let's make this input
look a little bit nicer.

61
00:05:48.724 --> 00:05:51.950
First thing we wanna do is inherit
the same font family that we're using

62
00:05:51.950 --> 00:05:52.553
elsewhere.

63
00:05:52.553 --> 00:05:56.497
I'm gonna make the input a little larger.

64
00:05:56.497 --> 00:06:01.054
Say 2em, give it some padding, and

65
00:06:01.054 --> 00:06:05.031
make it filled with the screen.

66
00:06:05.031 --> 00:06:08.882
Am gonna give it a nice
translucent background.

67
00:06:11.770 --> 00:06:14.451
It's a very subtle, white color.

68
00:06:14.451 --> 00:06:18.609
I'm gonna remove the border cuz
the default browser styling for

69
00:06:18.609 --> 00:06:20.614
these elements is ugly as sin.

70
00:06:20.614 --> 00:06:22.002
Got a subtle border-radius.

71
00:06:25.884 --> 00:06:29.355
And we are gonna need to
give it a color as well.

72
00:06:29.355 --> 00:06:31.808
So make that white.

73
00:06:35.653 --> 00:06:38.359
I don't really like this
bright blue outline.

74
00:06:38.359 --> 00:06:43.159
Let's use the nice accent
color that we're using for

75
00:06:43.159 --> 00:06:50.425
the elements in our nav, we can do
that with a focus visible selector.

76
00:06:50.425 --> 00:06:55.461
Outline 2px solid and
use var accent like so.

77
00:06:59.430 --> 00:07:02.994
And we can now search for
all of the John Wick movies or

78
00:07:02.994 --> 00:07:05.593
whatever else we're interested in.

