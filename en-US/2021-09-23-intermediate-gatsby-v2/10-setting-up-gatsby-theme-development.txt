[00:00:00]
>> So let's do a quick recap of where we are on this site, right. So what we've done to date is we've made ourselves a website that will show us a list of books to show us a list of all authors. And let us see individual pages for those the way that we were able to create that was by customizing the way that Gatsby creates pages and the way that it pulls in data.

[00:00:22]
So we are pulling in some JSON data. This could be data from anywhere we could pull it in from third party API's or whatever we needed. And once we have that, we are defining some relationships between that data. And then we're creating data nodes for each one, which puts it into Gatsby's graph qL layer.

[00:00:43]
Then using that data actually, before we use the data, we get down to this create resolvers here, where we're able to extend the data with custom resolvers that give us new fields. So, we created a biol ink, which gives us the ability to link out and see a place to purchase.

[00:01:01]
And we also created a cover, which is a remote image. So we look up the book in the Open Library API. We then get a link to the book's cover image, and have Gatsby pull that in as a remote file node. And by configuring Gatsby config with image plugins, we're able to get an optimized image for each book cover.

[00:01:25]
So we got quite a ways here. But as you may have noticed, this is not the most visually appealing site, we've pretty much ignored the visuals of this site entirely. And what I wanna do is just kind of dig into how we can make this more visually appealing.

[00:01:46]
But in a way that if I wanted to build more sites like this in the future, I could reuse that content. And so to do that, we're gonna introduce what's known as Gatsby themes. So under the hood, a Gatsby theme is almost a Gatsby plugin. You install it the same way we're gonna put it into the plugins array, just like we would any other plug in.

[00:02:06]
But the difference is a Gatsby theme has a few special properties. One, it can extend our Gatsby config, so we can install our own plugins that way. And, we'll show you how that works here in a minute. You can provide components that will wrap things, which is what we're gonna do with this particular theme.

[00:02:26]
You can provide shared styles, you can do a whole lot of kind of foundational work that makes building multiple web sites even easier if they're all kind of in the same vein. So this is a really, really powerful approach if you are an agency developer. If you work with clients, and you want to have the ability for a lot of different websites to start with the same general boilerplate.

[00:02:50]
Whether that is, if you're building a front end that's a little more advanced, maybe you need to wrap everything in context providers. Maybe you've got some shared hooks that you use in almost every site that make your life a little bit easier. Or maybe you're using tailwind, and you've got a base config, any of those sorts of things can be wrapped up into a Gatsby theme.

[00:03:08]
And then installed onto a site so that you start at that point, without having to build your own starter that you can then maintain. The benefit of this is that if I use a starter, I'm getting a copy of that site, and all of its config and all of its components and everything that's in it.

[00:03:26]
And if I make changes, it's now completely diverged from the starter. If improvements get made to the starter, I have to manually port those into my code, which is, to be honest, probably never gonna happen. I've tried this a few times. Never in my history as a developer, unless I was under duress, have I voluntarily gone and gotten changes from upstream.

[00:03:49]
And lovingly ported them into my code, it's usually not possible because your code diverges to match. With a theme, though, a theme is an NPM package. It's separate from your site. So if a theme gets updated upstream, I can update the version of my theme. And assuming the authors didn't make any breaking changes, I just automatically get those improvements.

[00:04:09]
It's just like using Gatsby or just like using, any other NPM package. I do NPM install my theme at latest and boom, I got the changes. So this is a great way to keep things in sync. A really good example of this in practice is if you look at the Apollo graph qL doc's these are set up as themes.

[00:04:30]
So if you look at the docs, they have all of these different tools. And so each of these has its Doc's in a different place. And they're able to keep all of the common stuff, the sidebar styling, the shared header, the search functionality. All that lives in shared repos, but if we go and actually edit this.

[00:04:55]
We can see that this is like the Apollo docs. And then if I go to let's go to react, and I go to edit the React docs. This is in a different repo, so each of these is its own kind of thing. They're separately maintained, but they all have this really unified feel.

[00:05:13]
And that's because Trevor blades, who's the developer who built this did a really great job of setting up a series of shareable Gatsby themes. So this is a really powerful approach that you can take and use in your code. So let's start that, right? So the reason that we set up a mono repo is to make this as easy as possible to get started.

[00:05:33]
So I'm gonna create two new files in a new folder. So our theme, I want it to be called Gatsby theme shared now. Now I could put this in a slash packages folder or a slash themes folder, whatever, but no benefit in over nesting here, so I'm not gonna bother.

[00:05:51]
So I'm going to create a Gatsby config. And I'm also going to create a package JSON. And so the Gatsby config, all we need to start, is nothing. We're just gonna export an empty object. And the packagejson we're going to set a few basic details we want to know.

[00:06:11]
The name and we're gonna call it Gatsby theme, shared nav. Again, we're in a mono repo which means that whatever the folder name is, if this is what yarn workspaces are gonna use when we wanna start the theme or install the theme. So if these don't match, that can be kinda confusing.

[00:06:28]
So I would just say, if you don't wanna call it Gatsby theme shared now that's fine, but, call the folder and the package the same thing. And you gonna get real confused. Then we're gonna set a version, we're not gonna publish this today. So the version is more just to keep NPM from yelling at us, and then we're gonna set a main, and this is important.

[00:06:49]
Main will default to index.JS, but the main field is what node and NPM and yarn use. To determine whether a package is valid, so if you put in index js and there's no index js in here. Your theme will throw errors, it'll say it's incorrectly configured or no main export or something like that.

[00:07:11]
So you can and a common practice is created an index dot js and just it's a no op just put in a comment that's nothing to see here. And that's fine because then your main can be index.js. Or you can just change what this main field is. And the last thing we're gonna do is we're gonna set a license, and we'll call it MIT.

[00:07:30]
And so the reason that we set these fields is to register this as a package, and to prevent getting complaints like we don't wanna notice that our packages on license. Or notice that our version is invalid or something like that, those can all cause problems and just generally they cause headaches.

[00:07:48]
So now that we've done that, we can tell yarn to track this. So I'm gonna come in here, and I'm gonna to say Gatsby theme, shared nav, because now I wanna track this folder. And if I come out here, and I look at what's in our yarn workspaces, which you can do by doing yarn works spaces info, It's gonna show me two workspaces, one a site.

[00:08:11]
Okay, that makes sense, and then Gatsby theme shared nav here's its location and perfect. That's what we want, so now that I've got that, I'm going to add Gatsby to our theme. So yarn workspace, Gatsby. Oops, Gatsby theme. Shared nav, and you wanna add this as a peer dependency, because we don't want two copies of Gatsby, but we do wanna make sure that Gatsby is installed when you use this theme.

[00:08:40]
So peer dependency is a way to make that work. So the dash capital P is how we do that. And again, we're using a yarn workspace theme named ad. Instead of NPM install or yarn ad because we want to make sure that it shows up in this package JSON and not this package JSON.

[00:08:59]
And that's how yarn workspaces handle that. Okay, so we've installed, and now we're gonna install the custom theme into our site. So, how we do that is we get into our terminal, and we're going to say yarn workspace site add Gatsby theme shared nav. And to get it to pick up the local theme, we're gonna say at star, and I'm using z shell, which means I have to quote that star.

[00:09:30]
So at quoted star is how we're going to do this. So I hit enter. And instead of adding the remote theme, it links our dependencies and gives us what we want. And then I'm going to say, yarn workspaces info again. And now you can see site then here are workspace dependencies including the Gatsby theme, shared nap.

[00:09:57]
So this is what we wanted. This is what we were after we have a site that is now using the theme. And that theme is local for our development, which is gonna make our lives really easy. So if we do, we can start this right now but honestly, nothing will happen yet.

[00:10:16]
Because it's an empty theme, it's just kind of like there. So let's not even bother because if I started it, it would just start, we wouldn't even see that we installed the theme, it would just be like okay, your site started.

