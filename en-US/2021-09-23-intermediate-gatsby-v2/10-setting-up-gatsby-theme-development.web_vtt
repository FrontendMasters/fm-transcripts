WEBVTT

1
00:00:00.300 --> 00:00:03.260
So let's do a quick recap of
where we are on this site, right.

2
00:00:03.260 --> 00:00:08.016
So what we've done to date is
we've made ourselves a website

3
00:00:08.016 --> 00:00:12.970
that will show us a list of books
to show us a list of all authors.

4
00:00:12.970 --> 00:00:16.507
And let us see individual pages for
those the way that we were

5
00:00:16.507 --> 00:00:20.965
able to create that was by customizing
the way that Gatsby creates pages and

6
00:00:20.965 --> 00:00:22.825
the way that it pulls in data.

7
00:00:22.825 --> 00:00:27.470
So we are pulling in some JSON data.

8
00:00:27.470 --> 00:00:30.356
This could be data from anywhere we could
pull it in from third party API's or

9
00:00:30.356 --> 00:00:31.930
whatever we needed.

10
00:00:31.930 --> 00:00:36.530
And once we have that, we are defining
some relationships between that data.

11
00:00:36.530 --> 00:00:40.061
And then we're creating data nodes for
each one,

12
00:00:40.061 --> 00:00:43.267
which puts it into
Gatsby's graph qL layer.

13
00:00:43.267 --> 00:00:46.874
Then using that data actually,
before we use the data,

14
00:00:46.874 --> 00:00:49.637
we get down to this create resolvers here,

15
00:00:49.637 --> 00:00:55.040
where we're able to extend the data with
custom resolvers that give us new fields.

16
00:00:55.040 --> 00:00:59.752
So, we created a biol ink,
which gives us the ability to link out and

17
00:00:59.752 --> 00:01:01.890
see a place to purchase.

18
00:01:01.890 --> 00:01:05.660
And we also created a cover,
which is a remote image.

19
00:01:05.660 --> 00:01:09.240
So we look up the book
in the Open Library API.

20
00:01:09.240 --> 00:01:12.626
We then get a link to
the book's cover image, and

21
00:01:12.626 --> 00:01:16.670
have Gatsby pull that in
as a remote file node.

22
00:01:16.670 --> 00:01:20.564
And by configuring Gatsby
config with image plugins,

23
00:01:20.564 --> 00:01:25.500
we're able to get an optimized image for
each book cover.

24
00:01:25.500 --> 00:01:28.240
So we got quite a ways here.

25
00:01:28.240 --> 00:01:33.598
But as you may have noticed, this is
not the most visually appealing site,

26
00:01:33.598 --> 00:01:38.125
we've pretty much ignored
the visuals of this site entirely.

27
00:01:38.125 --> 00:01:42.852
And what I wanna do is just
kind of dig into how we can

28
00:01:42.852 --> 00:01:46.730
make this more visually appealing.

29
00:01:46.730 --> 00:01:50.274
But in a way that if I wanted to build
more sites like this in the future,

30
00:01:50.274 --> 00:01:51.820
I could reuse that content.

31
00:01:51.820 --> 00:01:56.270
And so to do that, we're gonna introduce
what's known as Gatsby themes.

32
00:01:57.390 --> 00:02:01.520
So under the hood,
a Gatsby theme is almost a Gatsby plugin.

33
00:02:01.520 --> 00:02:04.135
You install it the same way we're
gonna put it into the plugins array,

34
00:02:04.135 --> 00:02:06.070
just like we would any other plug in.

35
00:02:06.070 --> 00:02:10.388
But the difference is a Gatsby
theme has a few special properties.

36
00:02:10.388 --> 00:02:17.020
One, it can extend our Gatsby config, so
we can install our own plugins that way.

37
00:02:17.020 --> 00:02:20.005
And, we'll show you how that
works here in a minute.

38
00:02:20.005 --> 00:02:22.640
You can provide components
that will wrap things,

39
00:02:22.640 --> 00:02:26.060
which is what we're gonna do
with this particular theme.

40
00:02:26.060 --> 00:02:28.403
You can provide shared styles,

41
00:02:28.403 --> 00:02:33.434
you can do a whole lot of kind of
foundational work that makes building

42
00:02:33.434 --> 00:02:38.970
multiple web sites even easier if
they're all kind of in the same vein.

43
00:02:38.970 --> 00:02:42.860
So this is a really, really powerful
approach if you are an agency developer.

44
00:02:42.860 --> 00:02:46.547
If you work with clients, and
you want to have the ability for

45
00:02:46.547 --> 00:02:50.977
a lot of different websites to start
with the same general boilerplate.

46
00:02:50.977 --> 00:02:54.863
Whether that is, if you're building
a front end that's a little more advanced,

47
00:02:54.863 --> 00:02:57.890
maybe you need to wrap
everything in context providers.

48
00:02:57.890 --> 00:03:00.891
Maybe you've got some shared hooks that
you use in almost every site that make

49
00:03:00.891 --> 00:03:02.510
your life a little bit easier.

50
00:03:02.510 --> 00:03:05.742
Or maybe you're using tailwind,
and you've got a base config,

51
00:03:05.742 --> 00:03:08.988
any of those sorts of things can
be wrapped up into a Gatsby theme.

52
00:03:08.988 --> 00:03:12.746
And then installed onto a site so
that you start at that point,

53
00:03:12.746 --> 00:03:16.955
without having to build your own
starter that you can then maintain.

54
00:03:16.955 --> 00:03:21.414
The benefit of this is that if I use a
starter, I'm getting a copy of that site,

55
00:03:21.414 --> 00:03:26.210
and all of its config and all of its
components and everything that's in it.

56
00:03:26.210 --> 00:03:30.290
And if I make changes, it's now
completely diverged from the starter.

57
00:03:30.290 --> 00:03:35.663
If improvements get made to the starter, I
have to manually port those into my code,

58
00:03:35.663 --> 00:03:39.420
which is, to be honest,
probably never gonna happen.

59
00:03:39.420 --> 00:03:40.940
I've tried this a few times.

60
00:03:40.940 --> 00:03:45.346
Never in my history as a developer,
unless I was under duress,

61
00:03:45.346 --> 00:03:49.516
have I voluntarily gone and
gotten changes from upstream.

62
00:03:49.516 --> 00:03:51.413
And lovingly ported them into my code,

63
00:03:51.413 --> 00:03:55.310
it's usually not possible because
your code diverges to match.

64
00:03:55.310 --> 00:03:58.520
With a theme, though,
a theme is an NPM package.

65
00:03:58.520 --> 00:04:00.215
It's separate from your site.

66
00:04:00.215 --> 00:04:04.750
So if a theme gets updated upstream,
I can update the version of my theme.

67
00:04:04.750 --> 00:04:07.699
And assuming the authors didn't
make any breaking changes,

68
00:04:07.699 --> 00:04:09.980
I just automatically
get those improvements.

69
00:04:09.980 --> 00:04:13.790
It's just like using Gatsby or
just like using, any other NPM package.

70
00:04:13.790 --> 00:04:17.500
I do NPM install my theme at latest and
boom, I got the changes.

71
00:04:17.500 --> 00:04:20.664
So this is a great way
to keep things in sync.

72
00:04:20.664 --> 00:04:25.707
A really good example of this
in practice is if you look

73
00:04:25.707 --> 00:04:30.990
at the Apollo graph qL doc's
these are set up as themes.

74
00:04:30.990 --> 00:04:37.880
So if you look at the docs,
they have all of these different tools.

75
00:04:37.880 --> 00:04:41.490
And so each of these has its
Doc's in a different place.

76
00:04:41.490 --> 00:04:44.491
And they're able to keep
all of the common stuff,

77
00:04:44.491 --> 00:04:49.140
the sidebar styling, the shared header,
the search functionality.

78
00:04:49.140 --> 00:04:55.254
All that lives in shared repos, but
if we go and actually edit this.

79
00:04:55.254 --> 00:04:59.140
We can see that this is
like the Apollo docs.

80
00:04:59.140 --> 00:05:05.550
And then if I go to let's go to react,
and I go to edit the React docs.

81
00:05:05.550 --> 00:05:09.790
This is in a different repo, so
each of these is its own kind of thing.

82
00:05:09.790 --> 00:05:13.620
They're separately maintained, but
they all have this really unified feel.

83
00:05:13.620 --> 00:05:17.960
And that's because Trevor blades, who's
the developer who built this did a really

84
00:05:17.960 --> 00:05:21.980
great job of setting up a series
of shareable Gatsby themes.

85
00:05:21.980 --> 00:05:27.680
So this is a really powerful approach
that you can take and use in your code.

86
00:05:27.680 --> 00:05:29.920
So let's start that, right?

87
00:05:29.920 --> 00:05:32.811
So the reason that we set up a mono
repo is to make this as easy as possible

88
00:05:32.811 --> 00:05:33.930
to get started.

89
00:05:33.930 --> 00:05:37.150
So I'm gonna create two
new files in a new folder.

90
00:05:37.150 --> 00:05:41.332
So our theme, I want it to be
called Gatsby theme shared now.

91
00:05:41.332 --> 00:05:46.236
Now I could put this in a slash packages
folder or a slash themes folder,

92
00:05:46.236 --> 00:05:51.700
whatever, but no benefit in over
nesting here, so I'm not gonna bother.

93
00:05:51.700 --> 00:05:55.831
So I'm going to create a Gatsby config.

94
00:05:55.831 --> 00:05:58.750
And I'm also going to
create a package JSON.

95
00:06:00.390 --> 00:06:03.760
And so the Gatsby config,
all we need to start, is nothing.

96
00:06:03.760 --> 00:06:05.840
We're just gonna export an empty object.

97
00:06:05.840 --> 00:06:11.500
And the packagejson we're going to set
a few basic details we want to know.

98
00:06:11.500 --> 00:06:15.990
The name and we're gonna call
it Gatsby theme, shared nav.

99
00:06:15.990 --> 00:06:20.600
Again, we're in a mono repo which means
that whatever the folder name is,

100
00:06:20.600 --> 00:06:25.209
if this is what yarn workspaces are gonna
use when we wanna start the theme or

101
00:06:25.209 --> 00:06:26.470
install the theme.

102
00:06:26.470 --> 00:06:28.940
So if these don't match,
that can be kinda confusing.

103
00:06:28.940 --> 00:06:32.788
So I would just say, if you don't wanna
call it Gatsby theme shared now that's

104
00:06:32.788 --> 00:06:35.778
fine, but, call the folder and
the package the same thing.

105
00:06:35.778 --> 00:06:36.819
And you gonna get real confused.

106
00:06:37.860 --> 00:06:40.840
Then we're gonna set a version,
we're not gonna publish this today.

107
00:06:40.840 --> 00:06:45.379
So the version is more just to
keep NPM from yelling at us, and

108
00:06:45.379 --> 00:06:49.650
then we're gonna set a main,
and this is important.

109
00:06:49.650 --> 00:06:52.842
Main will default to index.JS,

110
00:06:52.842 --> 00:06:58.110
but the main field is what node and
NPM and yarn use.

111
00:06:58.110 --> 00:07:03.036
To determine whether a package is valid,
so if you put in index js and

112
00:07:03.036 --> 00:07:05.206
there's no index js in here.

113
00:07:05.206 --> 00:07:09.343
Your theme will throw errors,
it'll say it's incorrectly configured or

114
00:07:09.343 --> 00:07:11.960
no main export or something like that.

115
00:07:11.960 --> 00:07:15.812
So you can and a common practice
is created an index dot js and

116
00:07:15.812 --> 00:07:20.660
just it's a no op just put in
a comment that's nothing to see here.

117
00:07:20.660 --> 00:07:23.940
And that's fine because then
your main can be index.js.

118
00:07:23.940 --> 00:07:25.630
Or you can just change
what this main field is.

119
00:07:26.650 --> 00:07:29.347
And the last thing we're gonna do
is we're gonna set a license, and

120
00:07:29.347 --> 00:07:30.440
we'll call it MIT.

121
00:07:30.440 --> 00:07:35.400
And so the reason that we set these fields
is to register this as a package, and to

122
00:07:35.400 --> 00:07:40.822
prevent getting complaints like we don't
wanna notice that our packages on license.

123
00:07:40.822 --> 00:07:43.670
Or notice that our version is invalid or
something like that,

124
00:07:43.670 --> 00:07:46.979
those can all cause problems and
just generally they cause headaches.

125
00:07:48.090 --> 00:07:52.980
So now that we've done that,
we can tell yarn to track this.

126
00:07:52.980 --> 00:07:57.041
So I'm gonna come in here, and
I'm gonna to say Gatsby theme, shared nav,

127
00:07:57.041 --> 00:07:59.140
because now I wanna track this folder.

128
00:08:00.150 --> 00:08:04.782
And if I come out here, and
I look at what's in our yarn workspaces,

129
00:08:04.782 --> 00:08:08.115
which you can do by doing
yarn works spaces info,

130
00:08:08.115 --> 00:08:11.920
It's gonna show me two workspaces,
one a site.

131
00:08:11.920 --> 00:08:13.856
Okay, that makes sense, and

132
00:08:13.856 --> 00:08:18.230
then Gatsby theme shared nav
here's its location and perfect.

133
00:08:18.230 --> 00:08:21.903
That's what we want, so
now that I've got that,

134
00:08:21.903 --> 00:08:24.710
I'm going to add Gatsby to our theme.

135
00:08:24.710 --> 00:08:27.660
So yarn workspace, Gatsby.

136
00:08:27.660 --> 00:08:29.810
Oops, Gatsby theme.

137
00:08:29.810 --> 00:08:33.253
Shared nav, and
you wanna add this as a peer dependency,

138
00:08:33.253 --> 00:08:36.195
because we don't want two
copies of Gatsby, but

139
00:08:36.195 --> 00:08:40.750
we do wanna make sure that Gatsby is
installed when you use this theme.

140
00:08:40.750 --> 00:08:42.970
So peer dependency is
a way to make that work.

141
00:08:42.970 --> 00:08:45.790
So the dash capital P is how we do that.

142
00:08:45.790 --> 00:08:49.290
And again, we're using a yarn
workspace theme named ad.

143
00:08:49.290 --> 00:08:53.997
Instead of NPM install or
yarn ad because we want to make sure

144
00:08:53.997 --> 00:08:59.540
that it shows up in this package JSON and
not this package JSON.

145
00:08:59.540 --> 00:09:01.979
And that's how yarn
workspaces handle that.

146
00:09:03.460 --> 00:09:05.364
Okay, so we've installed,

147
00:09:05.364 --> 00:09:09.260
and now we're gonna install
the custom theme into our site.

148
00:09:10.320 --> 00:09:15.043
So, how we do that is we
get into our terminal, and

149
00:09:15.043 --> 00:09:21.575
we're going to say yarn workspace
site add Gatsby theme shared nav.

150
00:09:21.575 --> 00:09:25.761
And to get it to pick up the local theme,
we're gonna say at star,

151
00:09:25.761 --> 00:09:30.270
and I'm using z shell,
which means I have to quote that star.

152
00:09:30.270 --> 00:09:34.400
So at quoted star is how
we're going to do this.

153
00:09:34.400 --> 00:09:35.500
So I hit enter.

154
00:09:35.500 --> 00:09:38.824
And instead of adding the remote theme,

155
00:09:38.824 --> 00:09:43.580
it links our dependencies and
gives us what we want.

156
00:09:43.580 --> 00:09:50.200
And then I'm going to say,
yarn workspaces info again.

157
00:09:50.200 --> 00:09:54.880
And now you can see site then here
are workspace dependencies including

158
00:09:54.880 --> 00:09:57.620
the Gatsby theme, shared nap.

159
00:09:57.620 --> 00:09:59.030
So this is what we wanted.

160
00:09:59.030 --> 00:10:04.610
This is what we were after we have
a site that is now using the theme.

161
00:10:04.610 --> 00:10:07.477
And that theme is local for
our development,

162
00:10:07.477 --> 00:10:10.202
which is gonna make our lives really easy.

163
00:10:11.904 --> 00:10:16.240
So if we do, we can start this right now
but honestly, nothing will happen yet.

164
00:10:16.240 --> 00:10:19.630
Because it's an empty theme,
it's just kind of like there.

165
00:10:21.550 --> 00:10:24.556
So let's not even bother because if
I started it, it would just start,

166
00:10:24.556 --> 00:10:27.860
we wouldn't even see that we installed
the theme, it would just be like okay,

167
00:10:27.860 --> 00:10:28.730
your site started.

