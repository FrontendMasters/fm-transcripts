WEBVTT

1
00:00:00.180 --> 00:00:05.860
Let's actually add this MDX support here
we're gonna add a few different things.

2
00:00:05.860 --> 00:00:10.660
The first thing that we're gonna add is a,
let's stop this development server.

3
00:00:10.660 --> 00:00:14.909
We're gonna install some stuff so
we're gonna install a source plugin for

4
00:00:14.909 --> 00:00:16.890
the file system.

5
00:00:16.890 --> 00:00:22.110
The reason for that We're gonna keep
our posts in another folder here.

6
00:00:22.110 --> 00:00:24.130
So let me close the open editors.

7
00:00:24.130 --> 00:00:28.910
And we're gonna create
a folder called posts.

8
00:00:30.390 --> 00:00:34.914
Now I want this folder to work
just like the pages folder where

9
00:00:34.914 --> 00:00:38.560
whatever we put in here
becomes a page in Gatsby.

10
00:00:39.850 --> 00:00:43.710
In order to do that, we need to
like Gatsby only looks for pages.

11
00:00:43.710 --> 00:00:46.650
So we need to make this
a special directory.

12
00:00:46.650 --> 00:00:52.231
And we're gonna do that with a combination
of Gatsby source file system,

13
00:00:52.231 --> 00:00:55.010
which will let us look up files.

14
00:00:55.010 --> 00:00:59.540
And then we're also going to use
a plugin called page creator.

15
00:00:59.540 --> 00:01:04.205
And what page creator does is it
lets us set any page in the site

16
00:01:04.205 --> 00:01:08.230
to have the same properties
as the pages directory so

17
00:01:08.230 --> 00:01:13.260
anything inside of this
should be created as a page.

18
00:01:13.260 --> 00:01:17.890
We also are gonna need
the Gatsby plugin for MDX.

19
00:01:17.890 --> 00:01:22.850
And then we need MDX itself so MDXJS/MDX.

20
00:01:22.850 --> 00:01:28.800
We're also gonna need the react
flavor of MDX so, MDX js react.

21
00:01:28.800 --> 00:01:32.560
Right, so
this is seems like a lot of stuff.

22
00:01:32.560 --> 00:01:39.850
This one is so that we can actually
load files into the Gatsby data layer.

23
00:01:40.970 --> 00:01:45.369
This one is so that we can turn any
folder into a special folder of

24
00:01:45.369 --> 00:01:48.120
files that will get turned into pages.

25
00:01:49.230 --> 00:01:53.008
The Gatsby plugin MDX which
is going to turn our files,

26
00:01:53.008 --> 00:01:57.540
from just plain old files,
it'll actually enable MDX support.

27
00:01:57.540 --> 00:02:01.528
And then the MDX things so
that we can use the MDX core and

28
00:02:01.528 --> 00:02:07.055
the react additional things that we
need to use it in a react project.

29
00:02:07.055 --> 00:02:08.227
So let's get those installed.

30
00:02:15.713 --> 00:02:18.645
And next, once we've got those installed,

31
00:02:18.645 --> 00:02:22.980
we're gonna go into our Gatsby config and
add support for these.

32
00:02:22.980 --> 00:02:29.096
So inside of this array we're going
to let me get this scaffolded and

33
00:02:29.096 --> 00:02:33.710
then I'll talk about what it actually is.

34
00:02:33.710 --> 00:02:37.492
So, by default,
if you just put in the name of a plug in,

35
00:02:37.492 --> 00:02:40.560
Gatsby will run that
plug in with no options.

36
00:02:42.030 --> 00:02:43.300
This is a shorthand.

37
00:02:43.300 --> 00:02:46.574
It's for convenience so that you don't
have to write out these big old objects

38
00:02:46.574 --> 00:02:48.660
every time you wanna do a plugin.

39
00:02:48.660 --> 00:02:51.484
But if a plugin does need configuration,

40
00:02:51.484 --> 00:02:54.800
then we tell it to resolve
the name of the plugin.

41
00:02:54.800 --> 00:02:57.920
So in our case, we're gonna start
with Gatsby source file system.

42
00:02:59.790 --> 00:03:01.660
And then we can pass options to it.

43
00:03:01.660 --> 00:03:06.380
So in our case, we're gonna give
this group of files a name,

44
00:03:06.380 --> 00:03:08.801
we're gonna call them posts.

45
00:03:08.801 --> 00:03:13.940
And we're going give them a path
of the dirname that's the current

46
00:03:13.940 --> 00:03:18.490
directory name, and
we're looking source and posts.

47
00:03:18.490 --> 00:03:20.974
So we're trying to find this directory and

48
00:03:20.974 --> 00:03:24.010
load all the files in it
into Gatsby's file system.

49
00:03:25.460 --> 00:03:30.345
So then we wanna make sure that Gatsby
will actually create pages from the pages

50
00:03:30.345 --> 00:03:31.912
that are found in there.

51
00:03:31.912 --> 00:03:35.431
So we're gonna set up Gatsby
plug in page creator.

52
00:03:35.431 --> 00:03:41.330
And for the options on that,
we're actually gonna pass

53
00:03:41.330 --> 00:03:46.852
in the same path we want this
dirname source posts and

54
00:03:46.852 --> 00:03:51.872
that will cause Gatsby to
not only find these and

55
00:03:51.872 --> 00:03:54.527
load them into graph QL.

56
00:03:54.527 --> 00:03:58.671
But actually turned them into pages with
their own address that matches the name of

57
00:03:58.671 --> 00:03:59.220
the file.

58
00:04:01.890 --> 00:04:08.470
Next, we want to transform those files
from just plain old files into MDX nodes.

59
00:04:08.470 --> 00:04:12.380
And we do that using Gatsby plug in MDX.

60
00:04:12.380 --> 00:04:16.007
Let me scroll up here and
for the options on

61
00:04:16.007 --> 00:04:20.990
this; we're gonna start by
giving it a default layout.

62
00:04:20.990 --> 00:04:23.774
Actually, you know what,
let's start without a default layout and

63
00:04:23.774 --> 00:04:26.710
then we'll come back in and look at it so
that we can show the difference.

64
00:04:26.710 --> 00:04:27.990
So we'll add that in.

65
00:04:29.890 --> 00:04:31.937
Okay, so now that we've got this,

66
00:04:31.937 --> 00:04:36.840
we've got our file system we've got
the page creator, we've got plugin MDX.

67
00:04:36.840 --> 00:04:41.150
Let's go ahead and
add our first blog post.

68
00:04:41.150 --> 00:04:45.410
So let's add to I'm gonna add
one called first blog and

69
00:04:45.410 --> 00:04:50.510
we use the dot MDX extension to
signify that it is in fact MDX.

70
00:04:50.510 --> 00:04:52.960
So we'll give this some basic markdown.

71
00:04:52.960 --> 00:04:55.110
This is my first blog post.

72
00:04:56.230 --> 00:04:59.240
All right, we can save that.

73
00:04:59.240 --> 00:05:01.460
Two exclamation boys is too many.

74
00:05:01.460 --> 00:05:02.235
All right, let's go.

75
00:05:02.235 --> 00:05:05.860
Let's go in here and do another blog.

76
00:05:05.860 --> 00:05:11.272
Blog mdx, and in this one,
we will say, dang,

77
00:05:11.272 --> 00:05:15.718
this blog is even better
than the last one.

78
00:05:15.718 --> 00:05:19.900
All right, so now we've got
two blog posts, both are mdx.

79
00:05:19.900 --> 00:05:24.373
And you can see here we're not using
any mdx features we've just added in

80
00:05:24.373 --> 00:05:27.452
plain old markdown and
one of the reasons to use mdx

81
00:05:27.452 --> 00:05:31.990
it will actually add some react
stuff a little bit later on, but.

82
00:05:31.990 --> 00:05:34.228
I really like this setup,

83
00:05:34.228 --> 00:05:39.723
because what we've just done if
we start the server here again,

84
00:05:39.723 --> 00:05:44.606
is we have created the ability
to now add these files in and

85
00:05:44.606 --> 00:05:48.502
again, all we've done here is we've said.

86
00:05:48.502 --> 00:05:52.952
Hey, Gatsby look in the file
system in this posts folder and

87
00:05:52.952 --> 00:05:57.669
create something called posts and
then use your page creator to

88
00:05:57.669 --> 00:06:02.670
make pages out of anything in this
post directory and look for MDX.

89
00:06:03.770 --> 00:06:09.370
So, now that we've created this,
if we look in here, everything is running.

90
00:06:09.370 --> 00:06:11.810
Now I'm gonna go to that 404 page again.

91
00:06:11.810 --> 00:06:15.500
So I can just type in 404 and
it'll say hey, that's not a page.

92
00:06:15.500 --> 00:06:19.730
And down here I can see here's our first
blog and our another blog that we created.

93
00:06:21.090 --> 00:06:24.490
Okay, so this is fine ish.

94
00:06:24.490 --> 00:06:27.598
It looks like it picked up
our default styles, but

95
00:06:27.598 --> 00:06:33.200
it's not quite what we're after we're
missing our header and all those things.

96
00:06:33.200 --> 00:06:39.722
And what we could do and
this is a pain is we could go in here and

97
00:06:39.722 --> 00:06:46.768
we could say let's import layout
from components layout.js,

98
00:06:46.768 --> 00:06:51.220
and then we will export default layout.

99
00:06:52.240 --> 00:06:53.280
Is that gonna work?

100
00:06:53.280 --> 00:06:54.270
No, it wouldn't be like that.

101
00:06:54.270 --> 00:06:55.340
It would be like this.

102
00:06:55.340 --> 00:06:58.140
It has to be a component like this.

103
00:06:58.140 --> 00:07:02.900
So we would do layout and
then inside we would send the children,

104
00:07:02.900 --> 00:07:06.890
which means we have to get
the children as a prop.

105
00:07:06.890 --> 00:07:09.640
I don't ever do this, so I'm trying
to remember exactly how it works.

106
00:07:11.490 --> 00:07:12.490
There it is.

107
00:07:12.490 --> 00:07:14.564
Okay, so upon doing this,

108
00:07:14.564 --> 00:07:19.850
by doing a default export we've
provided a kind of a layout here.

109
00:07:19.850 --> 00:07:23.332
And if we wanted to do something like,
this is part of my blog.

110
00:07:26.007 --> 00:07:29.520
Then we can add custom markup.

111
00:07:29.520 --> 00:07:30.990
And this is all fine, right?

112
00:07:30.990 --> 00:07:33.470
But this is kind of,
I want to do that for every blog post.

113
00:07:33.470 --> 00:07:37.240
So instead what we can do is we
can get rid of that entirely.

114
00:07:38.520 --> 00:07:42.590
And we can come back out here and
I wanna set a default layout.

115
00:07:42.590 --> 00:07:47.504
So inside of Gatsby, plugin MDX,
one of the options that I have

116
00:07:47.504 --> 00:07:53.200
is to set a default layout And so
I'm gonna say default layouts.

117
00:07:53.200 --> 00:07:58.730
And for posts, this needs to match this.

118
00:07:58.730 --> 00:08:00.060
That's how that works.

119
00:08:00.060 --> 00:08:05.209
And we're gonna say required.resulve,
required.resolve is a way

120
00:08:05.209 --> 00:08:10.620
to get the node Internals to give you
like the absolute path to a file.

121
00:08:10.620 --> 00:08:15.705
So what we're doing is we
are doing the required.resolve

122
00:08:15.705 --> 00:08:19.769
to source components, layout.js, right?

123
00:08:19.769 --> 00:08:22.600
So now, we've got a default layout set and

124
00:08:22.600 --> 00:08:27.340
see our Gatsby saying we need to
restart because we change the config.

125
00:08:27.340 --> 00:08:28.590
I love this feature so we can hit OK.

126
00:08:28.590 --> 00:08:31.510
And it's gonna restart
the development server for us.

127
00:08:33.340 --> 00:08:36.341
And when it's done,
which we can watch happen over here.

128
00:08:39.416 --> 00:08:44.112
What we should see happen is the page
in the background is gonna refresh and

129
00:08:44.112 --> 00:08:46.710
it will actually use that layout.

130
00:08:46.710 --> 00:08:47.760
So check that out.

131
00:08:47.760 --> 00:08:49.810
We have our first blog post.

132
00:08:49.810 --> 00:08:50.850
So I'm happy about this.

133
00:08:50.850 --> 00:08:53.570
We've got, our blog post is here.

134
00:08:53.570 --> 00:08:56.080
It has the header.

135
00:08:56.080 --> 00:09:02.210
And again, we did not have to make
like we didn't have to add the layout.

136
00:09:02.210 --> 00:09:02.890
It's just there.

137
00:09:03.930 --> 00:09:07.156
And if we go to the other one, so
let me go back to this 404 page,

138
00:09:07.156 --> 00:09:09.720
click through to another blog.

139
00:09:09.720 --> 00:09:11.893
And there it is no
changes to another blog.

140
00:09:11.893 --> 00:09:16.155
Which again, no layout included, but
because we set a default it brings it in.

141
00:09:16.155 --> 00:09:21.813
Now we can override this if we wanted to
go back into the first blog, and instead

142
00:09:21.813 --> 00:09:27.495
of using the layout, I could just set it
as like a div and get rid of this layout.

143
00:09:28.965 --> 00:09:34.510
Then, this one stays the same
because we didn't edit it.

144
00:09:34.510 --> 00:09:39.990
But the first blog now it
doesn't have that setup, right?

145
00:09:39.990 --> 00:09:44.856
So we can optionally override whenever
if we need custom layouts, but

146
00:09:44.856 --> 00:09:47.500
by default, it'll use the same one.

147
00:09:48.870 --> 00:09:51.810
And that is a really nice feature that's
a really slick way to get this up

148
00:09:51.810 --> 00:09:53.280
and running.

149
00:09:53.280 --> 00:09:57.528
So this to me is a really powerful
workflow because with fairly minimal

150
00:09:57.528 --> 00:10:01.708
confide you know we like I know we
had to get into Gatsby confide here.

151
00:10:01.708 --> 00:10:06.482
And we had to add you know three plugins
and this can feel like a lot I think

152
00:10:06.482 --> 00:10:11.191
that one of the most overwhelming
parts of working with Gatsby can be.

153
00:10:11.191 --> 00:10:15.001
There's a lot of config it can start
to feel like it's hard to track

154
00:10:15.001 --> 00:10:16.520
what's going on.

155
00:10:16.520 --> 00:10:20.296
One way that you can group this is
you can actually just go in here and

156
00:10:20.296 --> 00:10:22.873
start adding comments
to let yourself know.

157
00:10:22.873 --> 00:10:28.282
This set of plugins is to enable creating

158
00:10:28.282 --> 00:10:35.300
MDX blog posts from the src/posts folder,
right?

159
00:10:35.300 --> 00:10:38.380
And then down here,
you can do end of MDX config.

160
00:10:38.380 --> 00:10:41.570
And then more config down here.

161
00:10:41.570 --> 00:10:45.085
So if you start to notice that you're
getting overwhelmed by the amount of

162
00:10:45.085 --> 00:10:47.480
things you're putting
into your Gatsby config.

163
00:10:47.480 --> 00:10:50.683
Leave yourself some signposts like let
yourself know why you did something or

164
00:10:50.683 --> 00:10:52.590
why it's configured the way it is.

165
00:10:52.590 --> 00:10:55.312
Our site is not particularly complex, so

166
00:10:55.312 --> 00:10:59.140
I'm not gonna stress too much
about doing all of that but.

167
00:11:01.310 --> 00:11:05.585
&gt;&gt; Is there a way to make that generic so
that it would pick up multiple

168
00:11:05.585 --> 00:11:09.720
folders not just posts would
I have to double that config?

169
00:11:09.720 --> 00:11:12.245
&gt;&gt; The the part that gets tricky
about this is the more generic these

170
00:11:12.245 --> 00:11:13.980
are the harder they are to track.

171
00:11:13.980 --> 00:11:17.806
So there's something to be said for
being pretty explicit about,

172
00:11:17.806 --> 00:11:20.310
what you're loading, and why.

173
00:11:20.310 --> 00:11:24.370
But again, this kinda comes
down to personal preference.

174
00:11:24.370 --> 00:11:30.280
The other thing to consider,
is if you just did that, it would work.

175
00:11:30.280 --> 00:11:36.160
But then you'd have in your graph
QL layer a bunch of extra stuff.

176
00:11:36.160 --> 00:11:41.520
But if we create another
folder inside of posts like,

177
00:11:41.520 --> 00:11:47.130
let's call this a series and
I let's copy one of these.

178
00:11:49.160 --> 00:11:53.620
Call this one like post one.

179
00:11:53.620 --> 00:11:54.750
This will get picked up in here.

180
00:11:54.750 --> 00:11:59.922
So if I go here now to series

181
00:11:59.922 --> 00:12:04.050
post one it works.

182
00:12:04.050 --> 00:12:09.294
So if you put a folder in all of the sub
folders will also get parsed and

183
00:12:09.294 --> 00:12:12.700
that's where this ignore option comes in.

184
00:12:12.700 --> 00:12:16.816
If you want it to ignore specialty
stuff like this one saying,

185
00:12:16.816 --> 00:12:19.517
ignore anything that starts with a dot.

186
00:12:19.517 --> 00:12:24.547
Or you could say, I only want to get
things that have the.page.JS suffix,

187
00:12:24.547 --> 00:12:28.190
if you want it to do
something kind of mixed.

188
00:12:28.190 --> 00:12:32.358
It's generally speaking easier to be
pretty explicit about like this is

189
00:12:32.358 --> 00:12:33.530
a folder for pages.

190
00:12:33.530 --> 00:12:38.261
So that then your folder directories tend
to line up pretty one to one like, okay,

191
00:12:38.261 --> 00:12:42.118
I'm in posts, so this means that
the URL will be /seriespost1.

192
00:12:42.118 --> 00:12:46.714
And that way you don't have to remember
like, yeah, it'll work like that except

193
00:12:46.714 --> 00:12:50.130
for this one that we ignored
because it's for utilities.

194
00:12:50.130 --> 00:12:52.465
Like if you've got utilities,
pull them out of the post folder and

195
00:12:52.465 --> 00:12:53.780
put them somewhere else.

196
00:12:53.780 --> 00:12:58.270
And in that way, you don't have to have
these like exclusions and special cases.

197
00:12:58.270 --> 00:13:01.747
Generally speaking,
like The easier you make it on yourself,

198
00:13:01.747 --> 00:13:04.910
the happier you'll be in the long term for
maintenance.

199
00:13:06.180 --> 00:13:10.750
&gt;&gt; Is there any way to pass like metadata
with the config other than just wrapping

200
00:13:10.750 --> 00:13:14.180
it in a layout tag and
then passing it to the props?

201
00:13:14.180 --> 00:13:16.874
&gt;&gt; Yep.
We're actually gonna do that right now I

202
00:13:16.874 --> 00:13:17.410
think.

