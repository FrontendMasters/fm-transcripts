WEBVTT

1
00:00:00.020 --> 00:00:05.181
&gt;&gt; Steve Kinney: Let's do like
the next one is either incredibly

2
00:00:05.181 --> 00:00:09.061
practical or not practical at all.

3
00:00:09.061 --> 00:00:13.309
But it's like,
it's the treat we all earned from

4
00:00:13.309 --> 00:00:17.861
listening to me try to
explain Transformers before,

5
00:00:17.861 --> 00:00:23.440
which from the name alone should tell you,
this is gonna be good.

6
00:00:27.770 --> 00:00:32.383
I decided that the appropriate
thing to do at this point in

7
00:00:32.383 --> 00:00:37.490
the presentation was to use
the cheesiest stock photography.

8
00:00:37.490 --> 00:00:40.730
This is not AI generated,
this is stock photography.

9
00:00:41.930 --> 00:00:42.750
And it just felt right.

10
00:00:42.750 --> 00:00:46.472
I think all these, every time
you see a presentation about AI,

11
00:00:46.472 --> 00:00:48.890
it's AI image here, AI image there.

12
00:00:48.890 --> 00:00:51.130
All these images are stock photography.

13
00:00:51.130 --> 00:00:55.855
Cause I felt like that was
like to show that we have

14
00:00:55.855 --> 00:01:01.210
been destroying art way before, before AI.

15
00:01:01.210 --> 00:01:03.730
Okay, so Dreambooth is a technique.

16
00:01:03.730 --> 00:01:06.890
It is effectively just
to ruin the lead here.

17
00:01:08.650 --> 00:01:13.152
If the stuff we were doing with Laura and

18
00:01:13.152 --> 00:01:19.701
parameter fission fine tuning
a little bit ago was ways to

19
00:01:19.701 --> 00:01:25.977
basically fine tune a text
model in a lightweight way,

20
00:01:25.977 --> 00:01:31.299
then Dreambooth is
effectively a lightweight

21
00:01:31.299 --> 00:01:35.412
way to fine tune stable diffusion.

22
00:01:35.412 --> 00:01:42.763
And if we said fine tune is for getting
the style of something that you want,

23
00:01:42.763 --> 00:01:48.362
then this is, I would say,
more for the subject matter,

24
00:01:48.362 --> 00:01:53.260
but a way to train one of
these models very easily on

25
00:01:53.260 --> 00:01:58.303
a subject that you choose and
with very few inputs.

26
00:01:58.303 --> 00:02:04.240
And it's effectively a hack,
which is we know everything.

27
00:02:04.240 --> 00:02:07.280
This is the prize that we deserved, right?

28
00:02:07.280 --> 00:02:11.093
We know that the way these things work
is they take to your question earlier.

29
00:02:11.093 --> 00:02:14.735
What happens if I give it
a word it doesn't know, right?

30
00:02:14.735 --> 00:02:18.380
We did not get the reward we wanted
to by seeing weird unknown tokens.

31
00:02:18.380 --> 00:02:20.260
We just got garbage.

32
00:02:20.260 --> 00:02:25.865
If you make up a new term that
stable diffusion doesn't know and

33
00:02:25.865 --> 00:02:31.380
then you show it a bunch of
pictures of that term, guess what?

34
00:02:31.380 --> 00:02:33.060
You've taught it?

35
00:02:33.060 --> 00:02:38.830
You've taught it a new term that it
uses when it's denoising things, right?

36
00:02:38.830 --> 00:02:44.910
So basically the canonical
example is SKS dog.

37
00:02:44.910 --> 00:02:45.988
That's somebody's dog or whatever.

38
00:02:45.988 --> 00:02:51.401
But you have to make some kind of made up,

39
00:02:51.401 --> 00:02:55.870
nonsensical term, right?

40
00:02:55.870 --> 00:03:01.770
And then what you do is
you upload some number

41
00:03:01.770 --> 00:03:08.149
of pictures of that thing
of that made up term and

42
00:03:08.149 --> 00:03:13.100
you say this is made up term, right?

43
00:03:13.100 --> 00:03:17.361
And you train it so
that when it hears made up term,

44
00:03:17.361 --> 00:03:22.027
it thinks about that image and
you can get away with like

45
00:03:22.027 --> 00:03:26.601
three to ten made up images and
get shockingly close.

46
00:03:26.601 --> 00:03:31.392
And again, I'm gonna use,
I think with this one,

47
00:03:31.392 --> 00:03:35.300
I think it works on the free one, it does.

48
00:03:35.300 --> 00:03:38.300
It will get a cup of coffee if
you're running on the free one.

49
00:03:39.820 --> 00:03:41.820
If not,
I will tweak it a little bit later.

50
00:03:41.820 --> 00:03:42.842
I'm pretty sure it does.

51
00:03:42.842 --> 00:03:47.300
But I was trying to refactor it and
things went a little poorly.

52
00:03:47.300 --> 00:03:50.100
So I definitely tested a lot
more on the big boy one.

53
00:03:50.100 --> 00:03:54.675
Cuz I was like, I needed the cycles
to go a little bit faster for myself.

54
00:03:54.675 --> 00:03:58.332
But you can basically then as
long as you reference that thing,

55
00:03:58.332 --> 00:04:01.090
you will get versions of that, right.

56
00:04:01.090 --> 00:04:03.250
And so I will shows you.

57
00:04:04.930 --> 00:04:08.172
Cause it kind of begins to open up the
door of like even like the image to image

58
00:04:08.172 --> 00:04:09.090
stuff is cool.

59
00:04:09.090 --> 00:04:11.302
I think like some of
the generating the images,

60
00:04:11.302 --> 00:04:13.330
like the piecing these things together.

61
00:04:13.330 --> 00:04:14.452
Right.
I always say that like

62
00:04:14.452 --> 00:04:17.450
there are some things where it's like
definitely you should learn this thing.

63
00:04:17.450 --> 00:04:18.330
Cause it's important for your job.

64
00:04:18.330 --> 00:04:22.686
And there's some that are important
because like my hope from some of this is

65
00:04:22.686 --> 00:04:27.382
that like a week from now you'll be like,
but what if I took the question answering

66
00:04:27.382 --> 00:04:30.990
stuff and the classification stuff and
this other thing.

67
00:04:30.990 --> 00:04:32.670
The interesting part is the overlap.

68
00:04:32.670 --> 00:04:37.143
But Dreambooth basically
is a way to effectively to

69
00:04:37.143 --> 00:04:41.310
fine tune one of these
models make playground.

70
00:04:42.590 --> 00:04:47.830
What we're going to do is definitely

71
00:04:47.830 --> 00:04:53.244
going to install some dependencies.

72
00:04:53.244 --> 00:04:56.857
Nothing totally special here.

73
00:04:56.857 --> 00:05:01.024
There's a lot of extra little libraries.

74
00:05:01.024 --> 00:05:04.066
We're gonna walk through
code step by step.

75
00:05:04.066 --> 00:05:10.920
I did at one point try to comment on a lot
of the lines explaining what they do.

76
00:05:10.920 --> 00:05:13.580
But even me reading them
to you is gonna be rough.

77
00:05:13.580 --> 00:05:18.369
I think the concept is again a version
of fine tuning with a relatively small

78
00:05:18.369 --> 00:05:22.561
data set on a relatively small
model gives you great win, right?

79
00:05:22.561 --> 00:05:26.800
So what we're going to do
is we're going to take.

80
00:05:26.800 --> 00:05:30.120
I forget which version of stable
diffusion I chose at the end of the day.

81
00:05:30.120 --> 00:05:33.800
But luckily it is very clear in
the code somewhere we are going.

82
00:05:33.800 --> 00:05:34.680
And you can do this too.

83
00:05:34.680 --> 00:05:35.760
You can run this.

84
00:05:35.760 --> 00:05:39.240
In fact it'd be cool if somebody
wanted to do it on the small one.

85
00:05:39.240 --> 00:05:39.960
Just to verify.

86
00:05:39.960 --> 00:05:42.480
Just don't tell me on camera if it
doesn't work, I'll fix it later.

87
00:05:42.480 --> 00:05:43.969
Just tell me privately.

88
00:05:43.969 --> 00:05:48.270
What we're gonna do is we're gonna
come up with some new parameter.

89
00:05:50.350 --> 00:05:51.472
Like I said before,

90
00:05:51.472 --> 00:05:56.110
the canonical one is this SKS dog
because it doesn't mean anything.

91
00:05:56.110 --> 00:06:02.079
The only core criteria is that it
has to be something ridiculous and

92
00:06:02.079 --> 00:06:05.070
you need to use it consistently.

93
00:06:08.270 --> 00:06:14.705
This was good enough in

94
00:06:14.705 --> 00:06:20.806
a lot of cases, but.

95
00:06:20.806 --> 00:06:22.600
And that should be
interpolated everywhere.

96
00:06:22.600 --> 00:06:25.480
If it doesn't I will go find it and
fix it.

97
00:06:27.320 --> 00:06:34.573
And what we do is Google Collab has this
neat feature where you run this cell and

98
00:06:34.573 --> 00:06:42.450
you can pick files on your file system and
upload it into the notebook space.

99
00:06:42.450 --> 00:06:47.590
So if you just try to hit run all the only
thing that will block you is this

100
00:06:47.590 --> 00:06:52.924
one because it'll be waiting for
you to upload pictures until you do it.

101
00:06:52.924 --> 00:06:56.042
So yeah, my dependencies are installed.

102
00:06:56.042 --> 00:06:59.290
So next I'm going to do this and
you can see I get this choose files.

103
00:06:59.290 --> 00:07:04.900
Here I have ten pictures of my dog.

104
00:07:04.900 --> 00:07:08.528
And I think to make the magic trick
important, I'm not trying to show you my

105
00:07:08.528 --> 00:07:11.180
dog like that guy who shows
you his dog all the time.

106
00:07:11.180 --> 00:07:15.345
But like this is what
Bonnabelle looks like.

107
00:07:15.345 --> 00:07:16.505
This is Bon Bon.

108
00:07:16.505 --> 00:07:18.380
I'm not looking for like pandering.

109
00:07:18.380 --> 00:07:19.740
She's cute, we all know that.

110
00:07:21.100 --> 00:07:23.820
The point is commit this dog to memory.

111
00:07:23.820 --> 00:07:25.260
It will be important later.

112
00:07:25.260 --> 00:07:26.140
Okay?

113
00:07:26.140 --> 00:07:27.980
That's all I'm trying to say.

114
00:07:27.980 --> 00:07:29.740
I'm not trying to show off my dog.

115
00:07:29.740 --> 00:07:31.770
She's a pit bull, she's fine.

116
00:07:31.770 --> 00:07:32.810
There are cuter dogs out there.

117
00:07:32.810 --> 00:07:34.810
I've seen them, A lot of them.

118
00:07:34.810 --> 00:07:38.090
There's huskies,
there's tons of cuter dogs in my dog.

119
00:07:38.090 --> 00:07:41.210
But that's my dog and that's important for
the story that I'm telling right now.

120
00:07:43.210 --> 00:07:45.370
Then we have some amount
of just preparing the data.

121
00:07:46.570 --> 00:07:47.450
I will show you.

122
00:07:47.450 --> 00:07:51.690
It's just mostly setting
the size based on the property.

123
00:07:51.690 --> 00:07:55.370
It's just mostly creating a data structure
that has everything I need in it.

124
00:07:56.410 --> 00:08:00.010
Arguably this is where I was like
I should simplify this all down.

125
00:08:00.010 --> 00:08:05.100
And that's when I broke things so
I didn't, mostly.

126
00:08:05.100 --> 00:08:07.620
Okay, go get all the images
in the right directory.

127
00:08:07.620 --> 00:08:12.140
Just some non glamorous
given the directory.

128
00:08:12.140 --> 00:08:14.500
Go look in the directory,
get all the files.

129
00:08:14.500 --> 00:08:20.489
Only the ones that are images, not sub
directories, all that kind of fun stuff.

130
00:08:20.489 --> 00:08:26.681
We do use this thing in this technique
which I think is interesting, which is

131
00:08:26.681 --> 00:08:33.580
you can also get better results by priming
it with this prior preservation, right.

132
00:08:33.580 --> 00:08:39.014
And so I gave it ten pictures
of a pitbull, right?

133
00:08:39.014 --> 00:08:43.678
A trick is then also have
it also like generate

134
00:08:43.678 --> 00:08:48.640
a bunch of pictures like especially for
a dog.

135
00:08:48.640 --> 00:08:50.966
If you had like a very unique
like favorite action figure or

136
00:08:50.966 --> 00:08:53.960
something like that, you're gonna get
this could be a little bit easier.

137
00:08:53.960 --> 00:08:54.860
But for a dog,

138
00:08:54.860 --> 00:08:59.910
you know, to prime it with like more
pictures of pit bulls doesn't hurt.

139
00:08:59.910 --> 00:09:02.950
Totally optional step, right?

140
00:09:02.950 --> 00:09:06.136
In fact, even if you have like at one
point I had Like I did a cat first and

141
00:09:06.136 --> 00:09:07.110
the cat was in there.

142
00:09:07.110 --> 00:09:07.910
I still got good results.

143
00:09:09.110 --> 00:09:10.918
I grabbed a stable diffusion 2 and

144
00:09:10.918 --> 00:09:13.750
then this is how strong you
want that prior art to be.

145
00:09:13.750 --> 00:09:15.436
Right.
Like clearly I want my pictures

146
00:09:15.436 --> 00:09:15.950
to be more.

147
00:09:15.950 --> 00:09:18.046
I'm just trying to like
prime the pump a little bit.

148
00:09:18.046 --> 00:09:21.490
More descriptions of
stuff we already talked

149
00:09:21.490 --> 00:09:26.394
about before that U-Net is basically
how much noise do we want?

150
00:09:26.394 --> 00:09:33.030
And the denoising, all of the fun stuff
that we talked about in previous slides.

151
00:09:33.030 --> 00:09:36.582
So then what we're going to do is
we're going to load the model and

152
00:09:36.582 --> 00:09:40.670
as you can see effectively we're
pulling in that stable diffusion model.

153
00:09:40.670 --> 00:09:45.539
As you can see with this pre-trained
model, name of path, pre trained model,

154
00:09:45.539 --> 00:09:50.720
name of path we're pulling in stable
diffusion 2, I think I picked.

155
00:09:50.720 --> 00:09:52.331
Yeah.
And you can try out different models,

156
00:09:52.331 --> 00:09:53.120
they're here for you.

157
00:09:54.320 --> 00:09:59.270
Especially if you are trying
to do this on the free tier

158
00:09:59.270 --> 00:10:04.720
GPU definitely grab a smaller
older model as well.

159
00:10:04.720 --> 00:10:08.949
You won't get better results,
but you might A get results or B,

160
00:10:08.949 --> 00:10:13.100
cause depending on the images and
the size and stuff like that,

161
00:10:13.100 --> 00:10:16.880
you will be coasting right on
that GPU memory threshold.

162
00:10:18.050 --> 00:10:20.450
So like if you need to shrink your
images or something like that.

163
00:10:20.450 --> 00:10:23.654
But yeah, find a pet, a sock puppet,

164
00:10:23.654 --> 00:10:28.174
a favorite action figure,
a guitar, your MacBook.

165
00:10:28.174 --> 00:10:30.030
I don't care, yourself, right?

166
00:10:30.030 --> 00:10:33.570
Find three to ten pictures and
that's all we're gonna do, right?

167
00:10:33.570 --> 00:10:34.610
For this magic trick.

168
00:10:34.610 --> 00:10:40.663
We are going to find three to 10 pictures,
we are gonna upload them and we have.

169
00:10:40.663 --> 00:10:45.140
No, don't embarrass me.

170
00:10:45.140 --> 00:10:46.744
Did I not run the right cell?

171
00:10:46.744 --> 00:10:47.640
Cuz you got to run these cells in order.

172
00:10:47.640 --> 00:10:52.549
Yeah, I didn't run that cell.

173
00:10:52.549 --> 00:10:57.500
So we'll download those real quick,
coming.

174
00:10:57.500 --> 00:10:59.980
And then we'll set this one to
follow up right afterwards.

175
00:10:59.980 --> 00:11:03.380
So yeah, three to 10 pictures,
you don't need many more than that.

176
00:11:03.380 --> 00:11:06.220
Again, every picture you add
is going to add more time so

177
00:11:06.220 --> 00:11:07.820
you will get better results.

178
00:11:07.820 --> 00:11:10.540
But three times, about all you need.

179
00:11:10.540 --> 00:11:15.740
Obviously the closer to 10 it's gonna
process those and do all of the.

180
00:11:17.900 --> 00:11:21.910
As you were asking before, that image
is effectively going to associate those

181
00:11:21.910 --> 00:11:23.620
pictures with your made up term.

182
00:11:23.620 --> 00:11:27.100
The other thing is yes, your term needs
to be a word that does not exist.

183
00:11:27.100 --> 00:11:30.653
So if you put in, if you upload a bunch
of pictures of your computer and

184
00:11:30.653 --> 00:11:34.100
you say computer, you're not going
to get results that you want.

185
00:11:34.100 --> 00:11:37.420
You need to pick a word that does
not exist in the network at all.

186
00:11:37.420 --> 00:11:39.460
And we're gonna basically
do the lightest weight.

187
00:11:39.460 --> 00:11:42.620
Fine tuning to this image model
that we could possib come up with.

188
00:11:42.620 --> 00:11:46.760
All right, those models are downloading.

189
00:11:48.840 --> 00:11:52.280
We got these models coming in again.

190
00:11:54.920 --> 00:11:56.760
All the training parameters.

191
00:11:56.760 --> 00:11:58.165
Explain them all one by one.

192
00:11:58.165 --> 00:12:00.944
But again, the pre-model training
path is that one we picked earlier.

193
00:12:00.944 --> 00:12:04.040
These are just data structures
that we're going to pass in there.

194
00:12:05.640 --> 00:12:08.280
We do want to center crop the images
when we make them smaller.

195
00:12:09.840 --> 00:12:11.280
Lots of little fun things.

196
00:12:11.280 --> 00:12:15.459
Again, if you are depending on the size
of the GPU you're running or if you're

197
00:12:15.459 --> 00:12:19.440
running on CPU on your own computer,
you need to turn that number down.

198
00:12:19.440 --> 00:12:20.080
Go for it.

199
00:12:20.080 --> 00:12:24.440
The higher the numbers,
the more time everything's going to take.

200
00:12:24.440 --> 00:12:28.000
But this seemed to be the sweet spot for
testing it.

201
00:12:28.000 --> 00:12:30.640
But yeah,
I annotated every last one of them.

202
00:12:32.640 --> 00:12:38.389
Then we'll define a training function
which is simply passing it to this

203
00:12:38.389 --> 00:12:43.960
one hugging face library that we saw
before with some error catching.

204
00:12:45.560 --> 00:12:49.160
The idea is with this made up word
that does not exist in the network.

205
00:12:50.760 --> 00:12:52.374
What we should be able to do.

206
00:12:52.374 --> 00:12:56.983
I didn't, go away,
hide yourself, hide yourself.

207
00:12:56.983 --> 00:12:59.829
I didn't even want to really show you.

208
00:12:59.829 --> 00:13:02.377
We're gonna run this training process,
right?

209
00:13:02.377 --> 00:13:06.540
No, I'm gonna hit Run also, there you go.

210
00:13:06.540 --> 00:13:07.380
It will go in.

211
00:13:07.380 --> 00:13:09.993
We'll train the network with it and

212
00:13:09.993 --> 00:13:15.304
then hopefully what we'll see if the live
demo gods love us is the ability

213
00:13:15.304 --> 00:13:20.900
to kind of then use that model to create
pictures of that thing you uploaded.

214
00:13:20.900 --> 00:13:22.940
So if it's your dog,
you should be able to see.

215
00:13:22.940 --> 00:13:25.819
You'll be able to create pictures
of your dog in space, right?

216
00:13:25.819 --> 00:13:27.138
Your dog underwater, right?

217
00:13:27.138 --> 00:13:29.283
Cuz, again, you'll take that model,

218
00:13:29.283 --> 00:13:32.260
you'll fine tune it with
your special things, right?

219
00:13:32.260 --> 00:13:34.980
You'll create a new model on top
of again three to ten images.

220
00:13:36.420 --> 00:13:39.060
And then this is the part that takes long.

221
00:13:39.060 --> 00:13:42.634
So three to 10 images and then you will
see whatever it is that you wanted,

222
00:13:42.634 --> 00:13:46.381
whether it's your kid, your pet,
your favorite action figure, whatever,

223
00:13:46.381 --> 00:13:50.020
in different contexts using
that term to prime the network.

224
00:13:50.020 --> 00:13:51.540
So yeah, I'll show you a few examples.

225
00:13:51.540 --> 00:13:54.401
Like we have the one from
when we ran it earlier.

226
00:13:54.401 --> 00:13:55.453
Technically true.

227
00:13:55.453 --> 00:13:57.700
We have the one from when we ran earlier.

228
00:13:57.700 --> 00:14:02.169
And then I'll show you the kind of
examples of other ones that they have

229
00:14:02.169 --> 00:14:02.787
as well.

230
00:14:02.787 --> 00:14:03.718
And you can kind of see, let's see.

231
00:14:03.718 --> 00:14:05.720
Is this the one with the examples?

232
00:14:05.720 --> 00:14:08.360
No, Let me see if I can find.

233
00:14:08.360 --> 00:14:09.853
There's a bunch of like.

234
00:14:09.853 --> 00:14:14.006
It's interesting to watch the other ones
like based on sock puppets or whatever.

235
00:14:14.006 --> 00:14:18.046
I might pull that up in a second, because
I thought it was gonna be easier to

236
00:14:18.046 --> 00:14:20.666
find off the top of my
head than it actually was.

237
00:14:20.666 --> 00:14:24.810
But the point is pulling the stuff in.

238
00:14:24.810 --> 00:14:27.290
We have the one that came out of the oven,
Right.

239
00:14:27.290 --> 00:14:29.138
If we saw the dog earlier,

240
00:14:29.138 --> 00:14:34.850
that is the aforementioned dog on the moon
submarine did not work out super well.

241
00:14:34.850 --> 00:14:37.330
I will say that the capes were weird for
flying.

242
00:14:37.330 --> 00:14:41.450
I think the bigger models with
more time will 100% work better.

243
00:14:42.970 --> 00:14:46.730
But, like, considering the fact that
she has a bandana on most of the time.

244
00:14:46.730 --> 00:14:48.490
I know my dog has a bandana.

245
00:14:48.490 --> 00:14:49.690
It's weird.

246
00:14:49.690 --> 00:14:50.410
It's fine.

