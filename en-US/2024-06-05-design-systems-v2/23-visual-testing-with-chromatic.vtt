WEBVTT

1
00:00:00.260 --> 00:00:02.380
Now let's get to visual test.

2
00:00:02.380 --> 00:00:07.464
Now one thing I will say is this portion
of the show is totally optional,

3
00:00:07.464 --> 00:00:12.100
but it does involve at least
getting a Chromatic account.

4
00:00:12.100 --> 00:00:18.566
There's a bass line version of
Chromatic which is totally free,

5
00:00:18.566 --> 00:00:25.752
up to like 5,000 pushes or
something like that a month, whatever.

6
00:00:25.752 --> 00:00:28.571
Maybe tests, I don't remember.

7
00:00:28.571 --> 00:00:33.641
Now it is hard for me to walk you through
signing up for a Chromatic account

8
00:00:33.641 --> 00:00:39.230
when one has a Chromatic account, and
setting up a project and stuff like that.

9
00:00:39.230 --> 00:00:44.086
So there is a Illustrated
guide to that here.

10
00:00:44.086 --> 00:00:50.859
But let's kinda go over to chromatic.com,
sure, /start.

11
00:00:50.859 --> 00:00:52.686
That seems good.

12
00:00:52.686 --> 00:00:55.101
Choose from GitHub.

13
00:00:55.101 --> 00:00:56.296
We'll choose anthology.

14
00:00:56.296 --> 00:00:58.536
What kind of project is it?

15
00:00:58.536 --> 00:00:59.450
It's a storybook.

16
00:01:02.911 --> 00:01:04.724
So you can install Chromatic.

17
00:01:04.724 --> 00:01:07.005
I do think that I got that for
free with Storybook, but

18
00:01:07.005 --> 00:01:08.995
I'm gonna follow the rules here for
a minute.

19
00:01:13.082 --> 00:01:15.801
So it was already, no, we added it.

20
00:01:15.801 --> 00:01:20.312
Cool, cool, cool, and
then there's an idea of a project token,

21
00:01:20.312 --> 00:01:25.456
which I will delete later so I don't
blow through my account here as well.

22
00:01:25.456 --> 00:01:33.206
What this will do is it just attributes
this storybook with Chromatic, I think.

23
00:01:33.206 --> 00:01:37.933
So what Chromatic is used for is visual
regression testing, but you do need to

24
00:01:37.933 --> 00:01:42.661
store what they looked like last time to
see if they look different this time,

25
00:01:42.661 --> 00:01:43.191
right?

26
00:01:47.430 --> 00:01:50.698
Do you think I got rid
of that broken test?

27
00:01:50.698 --> 00:01:53.216
And it will run through
all of your stories.

28
00:01:53.216 --> 00:01:56.249
And then the first time around it
basically tries to figure out like,

29
00:01:56.249 --> 00:01:58.086
what does everything look like?

30
00:01:58.086 --> 00:02:02.381
And so now you can have a work flow where
you can work through everything and

31
00:02:02.381 --> 00:02:04.511
see, is this different or not?

32
00:02:04.511 --> 00:02:07.689
Sometimes different is good, sometimes
that's why you opened up the code base.

33
00:02:07.689 --> 00:02:11.481
Ideally, sometimes when we write code,
we seek to change something, right?

34
00:02:11.481 --> 00:02:12.994
It's just,
did we change the things we wanna change?

35
00:02:12.994 --> 00:02:18.691
Or even I showed you that code of our
button component, which is a mess.

36
00:02:18.691 --> 00:02:22.340
Don't look at that code as an example, the
code in this repo look good, look at it.

37
00:02:22.340 --> 00:02:26.418
Our button is a series
of choices over time.

38
00:02:26.418 --> 00:02:31.114
And so one of my missions next week or so,
is to sit down with the visual regression

39
00:02:31.114 --> 00:02:34.705
testing now the dark mode has
settled down, and go through and

40
00:02:34.705 --> 00:02:38.535
set up the visual regression testing and
then just refactoring.

41
00:02:38.535 --> 00:02:44.382
I don't want them to look any different,
but like, sure.

42
00:02:48.585 --> 00:02:52.337
Awesome, yeah,
I can set up an environment variable and

43
00:02:52.337 --> 00:02:56.571
all that extra fun stuff, but
we're not gonna do that just yet.

44
00:02:56.571 --> 00:03:03.659
And look, in Chromatic,
here are my components.

45
00:03:03.659 --> 00:03:08.521
We got a button, we got the callout,
and we got the text area.

46
00:03:08.521 --> 00:03:11.290
Those are the ones I have stories for
currently.

47
00:03:11.290 --> 00:03:16.540
And so, we can do something and
ideally we should see a change.

48
00:03:16.540 --> 00:03:21.907
But the really cool thing in Storybook 8,
I think this is somewhat new.

49
00:03:21.907 --> 00:03:22.714
What do we wanna mess with?

50
00:03:22.714 --> 00:03:23.337
Button or callout?

51
00:03:26.229 --> 00:03:27.360
Don't all answer at the same time.

52
00:03:27.360 --> 00:03:29.570
Call out?
All right, so we'll hit this.

53
00:03:32.981 --> 00:03:39.251
And what's super cool is
this is in development.

54
00:03:39.251 --> 00:03:40.924
I could run it,
I could do it on every push.

55
00:03:40.924 --> 00:03:44.522
We do it on our website,
we have it in the CI CD.

56
00:03:44.522 --> 00:03:48.756
But what's super cool about this is,
I'm in development right now,

57
00:03:48.756 --> 00:03:50.798
I am working, working.

58
00:03:50.798 --> 00:03:55.065
And so, what I can do is
let's go into the callout.

59
00:03:59.113 --> 00:04:04.631
And let's begin just something,

60
00:04:04.631 --> 00:04:07.871
right, like text.

61
00:04:07.871 --> 00:04:12.417
Let me put that in the actual class name,
text-2xl.

62
00:04:22.830 --> 00:04:25.802
I could hit Play as I'm working on this.

63
00:04:25.802 --> 00:04:29.450
It does a little bit of updating and
stuff along those lines.

64
00:04:32.223 --> 00:04:33.272
It runs the test.

65
00:04:33.272 --> 00:04:37.687
But the nice part is you can actually
see the changes and approve them.

66
00:04:37.687 --> 00:04:41.191
Cuz sometimes you do want,
visual regression, I guess,

67
00:04:41.191 --> 00:04:43.559
that's why they call it a visual test.

68
00:04:43.559 --> 00:04:45.449
All right,
we usually call it a regression,

69
00:04:45.449 --> 00:04:47.308
it implies that I didn't
want it to change.

70
00:04:47.308 --> 00:04:52.248
All right, in this case,
you can kinda see,

71
00:04:52.248 --> 00:04:56.675
is there an easy way to make this bigger?

72
00:04:56.675 --> 00:05:00.249
Unclear, but there's always an easy way to
make it bigger by clicking and zooming.

73
00:05:00.249 --> 00:05:05.302
But it will kinda show you an overlay of
the old and the new component, right?

74
00:05:05.302 --> 00:05:07.462
And so here you can see that obviously,

75
00:05:07.462 --> 00:05:11.077
it's a little taller now that
the font is in fact bigger, right?

76
00:05:11.077 --> 00:05:13.697
And obviously,
this was a very simple change.

77
00:05:13.697 --> 00:05:18.468
But you can see like, hey, this component
has changed from whatever the last time

78
00:05:18.468 --> 00:05:21.537
you push stuff into main and
approved things.

79
00:05:21.537 --> 00:05:26.032
And so you can actually say,
yeah, that was intentional and

80
00:05:26.032 --> 00:05:30.193
accepted our whoops,
didn't mean to do that, right?

81
00:05:30.193 --> 00:05:32.842
And it's a great way for
checking, obviously,

82
00:05:32.842 --> 00:05:36.601
the changes you want actually happen
as consistently as you want it.

83
00:05:36.601 --> 00:05:39.442
Cuz let's say you were intentionally
changing the button or

84
00:05:39.442 --> 00:05:40.556
some iconography, and

85
00:05:40.556 --> 00:05:44.413
you started to see some places where it
didn't change that you thought it should.

86
00:05:44.413 --> 00:05:45.836
That's useful information.

87
00:05:45.836 --> 00:05:50.679
Or did it actually like, I didn't even
realize that we're using this icon at

88
00:05:50.679 --> 00:05:53.290
that end of the code base and
I just removed.

89
00:05:53.290 --> 00:05:57.767
Something along those lines, be able to
catch all those things on a visual level.

90
00:05:57.767 --> 00:06:01.257
Like yeah, if you get really fancy with
the types, you'll get some of it for free.

91
00:06:01.257 --> 00:06:04.890
But I think being able to
catch it here as well, so

92
00:06:04.890 --> 00:06:08.347
I can hit Accept, and
I can push that up next and

93
00:06:08.347 --> 00:06:12.887
this becomes the new accepted
way to have call outs, right?

94
00:06:12.887 --> 00:06:17.872
And you can see that I can either
batch accept, because, yes,

95
00:06:17.872 --> 00:06:20.703
all the callouts changed, right?

96
00:06:20.703 --> 00:06:25.093
And it caught that, but they all changed
because I changed the font size and

97
00:06:25.093 --> 00:06:26.568
the actual parameters.

98
00:06:26.568 --> 00:06:31.610
So I can also go ahead and either accept
all the changes as one component,

99
00:06:31.610 --> 00:06:33.356
or everything, right?

100
00:06:33.356 --> 00:06:36.633
And so whatever you need is
the right choice in this case, and

101
00:06:36.633 --> 00:06:39.394
then you can choose to rerun the tests.

102
00:06:39.394 --> 00:06:44.649
And ideally, I think, since I accepted
them, I think that pushes them up.

103
00:06:44.649 --> 00:06:49.545
Normally it's running in CICD so
I don't think about it too much.

104
00:06:49.545 --> 00:06:52.310
Cuz we do have it set that you do
need to go and approve it in CI.

105
00:06:52.310 --> 00:06:54.401
I think a lot of this
functionality is relative,

106
00:06:54.401 --> 00:06:56.191
I think it went into
beta not too long ago.

107
00:06:56.191 --> 00:07:00.810
It's officially in Storybook 8 but
we've been running in CICD for a while.

108
00:07:00.810 --> 00:07:01.962
So that's normally how we've done it.

109
00:07:01.962 --> 00:07:05.661
But the concept is the same whether or not
you choose to run it through the GitHub

110
00:07:05.661 --> 00:07:09.318
action, going to the Chromatic UI, or
in this new kinda nice way to see that.

111
00:07:09.318 --> 00:07:13.401
Now there are no changes, cuz this is what
we accepted a call out should look like.

112
00:07:13.401 --> 00:07:17.661
If I reverted this change,
we'd get another visual regression change.

113
00:07:17.661 --> 00:07:21.966
Chromatic is not free, but
I think you get something like

114
00:07:21.966 --> 00:07:26.639
5000 comparisons and
then something along those lines.

115
00:07:26.639 --> 00:07:29.038
You can choose to use it,
you can choose not to use it.

116
00:07:29.038 --> 00:07:32.444
If you can trick your employer into
paying for it, that's even better.

117
00:07:32.444 --> 00:07:35.517
So I don't wanna belabor it too much,
I kinda wanna point out that one of

118
00:07:35.517 --> 00:07:38.656
the workflow is really great, two,
it exists, three, it's useful.

119
00:07:38.656 --> 00:07:40.413
But like I said,
I don't come here to sell you anything.

120
00:07:40.413 --> 00:07:41.230
I don't work for them.

